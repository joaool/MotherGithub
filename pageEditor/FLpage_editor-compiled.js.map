{"version":3,"sources":["FLpage_editor.js"],"names":[],"mappings":"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","file":"FLpage_editor-compiled.js","sourcesContent":["// unconnected test http://localhost/pdojo/MotherGithub/page_editor.html?=cs#\r\nvar FL = FL || {};\r\n(function() { //App is a name space.\r\n\t// http://jhollingworth.github.io/bootstrap-wysihtml5/ -- style change the whole line or nothing\r\n\t//\t\thttp://rcode5.wordpress.com/2012/11/01/custom-image-upload-modal-with-bootstrap-wysihtml5/\r\n\t// https://github.com/akzhan/jwysiwyg#web-site ---\r\n\t// http://www.wyzz.info/wysiwyg_page.html\r\n\t// http://wymeditor.github.io/wymeditor/dist/examples/01-basic.html\r\n\t// http://pietschsoft.com/demo/jHtmlArea/ -\r\n\t// http://imperavi.com/redactor/ ++ PAID PRODUCT poor documented  API\r\n\t// -->\thttp://premiumsoftware.net/cleditor/ \r\n\t// http://hackerwins.github.io/summernote/ +++ bootstrap3\r\n\t//     http://jsfiddle.net/lesson8/2AeHs/show/\r\n\t//     http://bootstrapvalidator.com/examples/summernote/\r\n\t// ---> http://mindmup.github.io/bootstrap-wysiwyg/ 5Kb ++\r\n\t//\t\thttp://www.jsdb.io/view/bootstrap-wysiwyg\r\n\t// http://madebymany.github.io/sir-trevor-js/ saves json\r\n\t// https://github.com/daviferreira/medium-editor - for blogs - operations not revertible...\r\n\t// http://jejacks0n.github.io/mercury/\r\n\t// ---> http://www.tinymce.com/develop/develop.php ++++  \r\n\t//\t\t\thttp://wiki.servicenow.com/index.php?title=Using_HTML_Fields\r\n\t// ---> http://ckeditor.com/demo + supporfts extensions bootstrap button edition ++++++\r\n\t//\t\thttp://ckeditor.com/addon/ckeditorbootstraputils\r\n\t//\t\thttp://doksoft.com/soft/ckeditor-bootstrap/ckeditor-bootstrap-button-plugin.html\r\n\t// http://www.scriptiny.com/2010/02/javascript-wysiwyg-editor/ - this is tinyEditor -- \r\n\t// http://xing.github.io/wysihtml5/\r\n\t// https://www.raptor-editor.com/\r\n\t// http://nicedit.com/ ++ can do plugins\r\n\t// http://www.aloha-editor.org/ ++\r\n\t// http://markitup.jaysalvat.com/home/ not a wysiwyg\r\n\t// http://innovastudio.com/BootstrapLiveEditor/index.html image galery no documented API !!!!\r\n\r\n\t// http://plugins.jquery.com/jquery.bootstrap-form-builder/\r\n\t// http://bootsnipp.com/forms?version=3 - form builder\r\n\t// http://www.userfox.com/transactional/\r\n\t// https://www.klaviyo.com/email-templates\r\n\r\n\t// https://github.com/hlxwell/mail-engine\r\n\t//http://www.invoicera.com/\r\n\t$(document).ready(function() {\r\n\t\t// alert(\"inside FLpage_editor\");\r\n\t\tvar fullUrl = window.location.href;\r\n\t\tvar API_key = null;\r\n\t\t// alert(fullUrl);\r\n\t\tif(fullUrl){//gets domain from url string ->http://localhost/pdojo/MotherGithub/test_menu13.html?d=myDomain1#\r\n\t\t\tpage = FL.common.getTag(fullUrl,\"page\",\"#\");//FL.domain is globally defined - the last # is disregarded\r\n\t\t\tvar style = FL.common.getTag(fullUrl,\"style\",\"#\");//FL.domain is globally defined - the last # is disregarded\r\n\t\t\tvar font = FL.common.getTag(fullUrl,\"font\",\"#\");//FL.domain is globally defined - the last # is disregarded\r\n\t\t\tFL.common.setStyleAndFont(style,font);\t\t\t//Now we will restore the style and font\r\n\t\t\t\r\n\t\t\tAPI_key = FL.common.getTag(fullUrl,\"API_key\",\"#\");//FL.domain is globally defined - the last # is disregarded\r\n\t\t\t\r\n\t\t\tvar loginObject = JSON.parse( FL.common.enc(API_key,-1) );//to remove...only for FL.common.printToConsole\r\n\t\t\t\r\n\t\t\tFL.API.debug = false;\r\n\t\t\tFL.API.debugFiltersToShow = [\"xAPI\",\"login\",\"peditor\",\"dd\"];//note that \"dump\" is a reserved word for FL.dd.displayEntities()\r\n\t\t\tFL.API.fl.setTraceClient(2);\r\n\r\n\t\t\tFL.common.printToConsole(\"FLpage_editor.js fullUrl=\"+fullUrl,\"peditor\");\r\n\t\t\tFL.common.printToConsole(\"FLpage_editor.js ** login=\"+JSON.stringify(loginObject),\"peditor\");//to remove...\r\n\t\t\tFL.common.printToConsole(\"FLpage_editor.js style=\"+style,\"peditor\");\r\n\t\t\tFL.common.printToConsole(\"FLpage_editor.js font=\"+font,\"peditor\");\r\n\t\t\t\r\n\t\t\tvar fl = new flMain();//only place where this must exist !!!!\r\n\t\t\tFL.fl = fl; //new flMain();\r\n\t\t\tfl.serverName(FL.common.getServerName());\r\n\t\t}else{\r\n\t\t\talert(\"inside FLpage_editor - ERROR fullUrl is empty\");\r\n\t\t}\r\n\t\tvar loadDefaultAppPromise = FL.API.loadDefaultAppByAPI_Key(API_key)\r\n\t\t\t.then(function(menuData,homeHTML){\r\n\t\t\t\tvar templateHTML = $('#pageEditorTemplate').html();\r\n\t\t\t\tFL.domInject(\"_placeHolder\",templateHTML );\r\n\t\t\t\t//-------- Replace headers\r\n\t\t\t\t$(\"#pageTitle\").empty();\r\n\t\t\t\t$(\"#pageTitle\").text(\"FrameLink - editing \" + page +\" page\");\r\n\t\t\t\t// --------\r\n\t\t\t\teditPage(\"home\",homeHTML);\r\n\t\t\t},function(err){\r\n\t\t\t\talert(\"FLpage_editor -> ERROR ->\"+err.code+\" - \"+err.message);\r\n\t\t\t\treturn;\r\n\t\t\t});\r\n\r\n\t\t/* working code - replaced because of new method FL.API.loadDefaultApp(loginObject)\r\n\t\tFL.API.connectUserToDefaultApp(loginObject.email,loginObject.password)\r\n\t\t.then(function(){\r\n\t\t\t\tFL.common.printToConsole(\"FLpage_editor -> success connecting to default app - Now we extract application data\");\r\n\t\t\t\tvar loadAppPromise=FL.API.loadAppDataForSignInUser2();//gets data dictionary + main menu + style + fontFamily + home page\r\n\t\t\t\tloadAppPromise.done(function(menuData,homeHTML){\r\n\t\t\t\t\tFL.common.printToConsole(\"appSetup ---> homeHTML=\" + homeHTML);\r\n\t\t\t\t\t// FL.common.printToConsole(\"appSetup --------------------------------------------->first menu=\" + menuData.oMenu.menu[0].title);\r\n\t\t\t\t\t// $('#pageEditorTemplate');\r\n\t\t\t\t\tvar templateHTML = $('#pageEditorTemplate').html();\r\n\t\t\t\t\tFL.domInject(\"_placeHolder\",templateHTML );\r\n\t\t\t\t\t//-------- Replace headers\r\n\t\t\t\t\t$(\"#pageTitle\").empty();\r\n\t\t\t\t\t$(\"#pageTitle\").text(\"FrameLink - editing \" + page +\" page\");\r\n\t\t\t\t\t// --------\r\n\t\t\t\t\teditPage(\"home\",homeHTML);\r\n\t\t\t\t});\r\n\t\t\t\tloadAppPromise.fail(function(err){\r\n\t\t\t\t\talert(\"FLpage_editor ->  --> after successfull connectUserToDefaultApp FAILURE in loadAppDataForSignInUser2 <<<<< error=\"+err);\r\n\t\t\t\t});\r\n\t\t\t},function(err){\r\n\t\t\t\tFL.common.printToConsole(\"FLpage_editor -> failure connecting to default app  err=\"+err);\r\n\t\t\t});\r\n\t\t*/\r\n\r\n\t\tvar editPage = function(pageName,htmlStr){\r\n\t\t\t// alert(\"continueFunction !!!! code to develop here !!! pageName=\"+pageName);\r\n\t\t\ttinymce.init({\r\n\t\t\t\tmode : \"textareas\",\r\n\t\t\t\tselector: \"textarea\",\r\n\t\t\t\t// language : \"es\", \r\n\t\t\t\ttheme : \"modern\",\r\n\t\t\t\tmenubar:false,\r\n\t\t\t\t// theme : \"advanced\",\r\n\t\t\t\tconvert_urls : false,\r\n\t\t\t\trelative_urls : false,\r\n\t\t\t\theight:400,\r\n\t\t\t\tplugins:[\r\n\t\t\t\t\t\"advlist autolink  link  print preview\",\r\n\t\t\t\t\t\"searchreplace wordcount visualchars code fullscreen\",\r\n\t\t\t\t\t\"media save contextmenu\",\r\n\t\t\t\t\t\"paste textcolor bdesk_photo framelink\"\r\n\t\t\t\t],\r\n\t\t\t\ttoolbar: \" undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link bdesk_photo  | forecolor backcolor | framelink | print code\",\r\n\t\t\t\tforced_root_block : \"\", //all these necessary to prevent injection fo <p> and </p>\r\n\t\t\t\tforce_br_newlines : true,\r\n\t\t\t\tforce_p_newlines : false,\r\n\t\t\t\tcontent_css : \"./FL_ui/css/FL\" + style + \".css\",\r\n\t\t\t\tsetup : function(ed) {\r\n\t\t\t\t\ted.on(\"init\",function(ed) {\r\n\t\t\t\t\t\ttinyMCE.get('my_editor').setContent(htmlStr);\r\n\t\t\t\t\t\ttinyMCE.execCommand('mceRepaint');\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tFL.common.printToConsole(\"-->\"+htmlStr);\r\n\t\t};\r\n\t});\r\n\texitSaving = function(){\r\n\t\tsHTML = tinyMCE.get('my_editor').getContent();\r\n\t\tFL.API.saveHomePage(sHTML)\r\n\t\t.then(function(){\r\n\t\t\t\t\tFL.common.printToConsole(\"FLpage_editor ->saved ok!\");\r\n\t\t\t\t\tFL.API.disconnect()\r\n\t\t\t\t\t.then(function(){FL.common.printToConsole(\"FLpage_editor->after sucessfull saveHomePage --> disconnect ok!\");closeWindows();return;} \r\n\t\t\t\t\t\t,function(err){FL.common.printToConsole(\"FLpage_editor->after sucessfull saveHomePage -->failure on disconnect err =\"+err);return;}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t,function(err){FL.common.printToConsole(\"FLpage_editor -> failure saving page err=\"+err);FL.API.disconnect();});\r\n\t};\r\n\texitNoSave = function(){\r\n\t\t// alert(\"exitNoSave\");\r\n\t\tFL.common.printToConsole(\"exitNoSave \");\r\n\t\tFL.API.disconnect()\r\n\t\t.then(function(){FL.common.printToConsole(\"FLpage_editor->no save --> disconnect ok!\");closeWindows();return;} \r\n\t\t\t,function(err){FL.common.printToConsole(\"FLpage_editor->no save -->failure on disconnect err =\"+err);return;}\r\n\t\t);\r\n\t};\r\n\twindow.onbeforeunload = function (e) {//works for close tab - and for close browser because:\r\n\t\t// TESTED Chrome 36 -try to close all tabs on by one, so it will fall back in this code. OK\r\n\t\t// TESTED FireFox 31 - try to close all tabs on by one, so it will fall back in this code. OK\r\n\t\t// TESTED IE 11 - try to close all tabs on by one, so it will fall back in this code. OK\r\n\t\t// TESTED Opera 9.80 - NOT WORKING - It is supported only after version 15 (Feb 2013 - In house Presto was phased ouyt in favour of WebKit)\r\n\t\t//TESTED Safari 5.1.7 - try to close all tabs on by one, so it will fall back in this code. OK\r\n\t\t// http://smallbusiness.chron.com/detecting-browser-windows-closing-firefox-49700.html\r\n\t\t//Chrome - detect tab close event ok - disconnect message ok - exiting message ok.\r\n\t\t//Firefox - detect tab close event ok - disconnect message ok - exiting message NOT OK. \r\n\t\t//IE - detect tab close event ok - disconnect message ok - exiting message ok.\r\n\t\t//Safari - detect tab close event ok - disconnect message ok - exiting message ok.\r\n\t\t//OPERA 9.80 - Not working see comment above\r\n\t\te = e || window.event;\r\n\t\tif (e) {\r\n\t\t\tFL.common.printToConsole(\"disconnect here\");\r\n\t\t\t// FL.server.disconnect();\r\n\t\t\te.returnValue = 'test returnValue...';\r\n\t\t}\r\n\t\treturn 'You are exiting FrameLink page editor...';\r\n\t};\r\n\tFL.common.printToConsole(document.title+\"......  END..\");\r\n})();\r\n"]}