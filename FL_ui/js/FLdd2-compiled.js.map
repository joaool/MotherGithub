{"version":3,"sources":["FLdd2.js"],"names":[],"mappings":"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","file":"FLdd2-compiled.js","sourcesContent":["// jQuery(document).ready(function($){\r\n\t/**\r\n\t* data dictionary UI methods \r\n\t*/\r\n\t// FL = FL || {}; //gives undefined if FL is undefined \r\n\t// FL = {};\r\n\t// // a=\"A\";\r\n\t// b=\"B\";\r\n\t// var a = (typeof a === 'undefined') ? b : a;//if a is defined returns \"A\" otherwise returns the content of b\r\n\t// alert(\"zzz=\"+a);//sets \"B\"\r\n\tFL = (typeof FL === 'undefined') ? {} : FL;\r\n\tFL[\"dd\"] = (function(){//name space FL.dd\r\n\t\t// entities={__Last:0,__LastRelation:0};//this is an object of objects (not an array of objects)\r\n\t\t//the key of the internal objects is the singular entity name\r\n\t\t\t//   {__Last:<number>,__LastRelation:<number>} is a special object with:\r\n\t\t\t//\t\t\t__Last - The total the number of entities. This is used to generate entity compressed names\r\n\t\t\t//\t\t\t__LastRelation - The total the number of relations. This is used to generate idRelation compressed names\r\n\t\t\t//   each internal object(entity) has: \r\n\t\t\t//      key:{singular:xSingular,csingular:xCSingular,plural:xPlural,description:xDescription,lastId:0,L2C:{},C2L:{},attributes:[]};\t\r\n\t\t\t//\t\tex:{\"Client\":{singular:\"Client\",\r\n\t\t\t//\t\t\t\t\tcsingular:\"01\",\r\n\t\t\t//\t\t\t\t\tplural:\"clients\",\r\n\t\t\t//\t\t\t\t\tdescription:\"Individual or Company to whom we may send invoices\",\r\n\t\t\t//\t\t\t\t\tsync:false,\r\n\t\t\t//\t\t\t\t\tlastId:0,\r\n\t\t\t//\t\t\t\t\tL2C:{},\r\n\t\t\t//\t\t\t\t\tC2L:{},\r\n\t\t\t//\t\t\t\t\tattributes:[]\t\r\n\t\t\t//\t\t\t\t\trelations:[]\t\r\n\t\t\t//\t\t}};\r\n\t\t\t//\r\n\t\t\t//  singular - is the human (logical) entitity name\r\n\t\t\t//\tcsingular - is the compressed entity name (does not change on renames)\r\n\t\t\t//  plural - plural expression corresponding to singular\r\n\t\t\t//  description - description of singular (answer to: \"what is a <singular> ?\")\r\n\t\t\t//\tsync - false if no synchronization was done with the server - true if synchronization was done\r\n\t\t\t//\t\t\t\t- if sync = false (default) csingular and all attributes fieldCN are temporary \r\n\t\t\t//\t\t\t\t- when sync = true - csingular and all attributes fieldCN are correct\r\n\t\t\t//  lastId - number of attributes of entity <singular>\r\n\t\t\t//\r\n\t\t\t//each attribute (i) is in dDictionary.entities[<sEentity>].attributes[i]\r\n\t\t\t//     with the format \r\n\t\t\t//\t\t{name:\"address\",description:\"address to send invoices\",label:\"Address\",type:\"string\",typeUI:\"textbox\",enumerable:null,key:false});\r\n\t\t\t//\r\n\t\t\t//\t\t\tname -  is the human (logical) attribute name or field name\r\n\t\t\t//\t\t\tdescription - description of attribute (answer to: \"what the <name > of a <entity.singular> ?\")\r\n\t\t\t//\t\t\tlabel - default value that will appear in UI labeling the attribute\r\n\t\t\t//\tOLD>>\ttype - one of: \"string\",\"number\",\"integer\",\"boolean\",\"date\",\"weak\" (a json object)\r\n\t\t\t//\t\t\ttype - string, integer, number, boolean, date, or json (Nico's field \"M\")\r\n\t\t\t//\t\t\t\tNOTE: if type is \"enumerable\", the key enumerable must have an array of enumerables\r\n\t\t\t//\t\t\t\tNOTE: type \"enumerable\" is invalid for server. \"enumerable\" will be send as type=\"string\" to server\r\n\t\t\t//\t\t\tenumerable - an array of enumerables or null (if key type != \"enumerable\")\r\n\t\t\t//\t\t\ttypeUI -type of widget that is used with the field (Nico's field \"9\")\r\n\t\t\t//\t\t\t\ttextbox, integerbox, numberbox, percentbox, currencybox, areabox, emailbox, phonebox, datetimebox, combobox,\r\n\t\t\t//\t\t\t\t\tcheckbox, urlbox, lookupbox -->TBI imagebox, geoBox\r\n\t\t\t//\t\t\tmask - applicable to textbox, integerbox, numberbox, percentbox and currencybox - null for other typeUI\r\n\t\t\t//\t\t\tspecialTypeDef - Special type definition . ex of specialtype is typeUI==\"lookup\" \r\n\t\t\t//\t\t\t\tif typeUI == \"lookup\" =>specialTypeDef=\"{eCN:<entity compressed name>, fCN:<field compressed name>}\"\r\n\t\t\t//\t\t\tkey - boolean. True means the attribute is the  key field of the entity . (only one allowed)\r\n\t\t\t//\tNEW TBD fieldPrefix - to be used only in search - for the time being it is fCN\r\n\t\t\t//\tNEW TBD Repeatable  - ex: [albert@monaco.mo ,toto@totoi.mo] true/false\r\n\t\t\t//\t\t\t\r\n\t\t\t//          NOTE: to access the field compressed name use L2C() at entity level.\r\n\t\t\t//\r\n\t\t\t// each relation (i) is in dDictionary.entities[<sEntity>].relations[i]\r\n\t\t\t//     with the format \r\n\t\t\t//     oRelation-->\t{idRelation:3,cIdRelation:\"03\",rightEntity:\"Invoice\",description:\"has\",cardinality:\"0_1\",semantic:\"Client has many Invoices\",delChildren:false});\r\n\t\t \t//    \t\tidRelation - key for database table \"relation\" int(11) autoincrement\r\n\t\t \t//    \t\tcIdRelation - compressed name corresponding to idRelation - independent identifier  \r\n\t\t\t//      Note: semantic property is redundant with all other relation properties and with the entity key.\r\n\t\t\t//      Sych Server \r\n\t\t\t//\t\t      //cIdRelation ->rCN returned has _id\r\n\t\t\t//\t\t\t  rightEntity ->entityCN ->U\r\n\t\t\t//\t\t\t              side - must be saved in the customer dictionary\r\n\t\t\t//\t\t\t  IF relation not reflexive\r\n\t\t\t//\t\t\t  \t\tdescription (change to verb) - V - if not reflexive\r\n\t\t\t//            IF relation reflexive\r\n\t\t\t//\t\t\t\t\ttwo entries are necessary with the same right entity -side must be saved one is 0 the other is 1\r\n\t\t\t//\t\t\t  cardinality :W ->0,1,N\r\n\t\t\t//\t\t\t  delChildren ->option TBD->\"02\":[{delChildren:true,....}]\r\n\t\t\t//\r\n\t\t\t//  ----- relation's object was completely changed to match Nico's approach - April 8, 2014\r\n\t\t\t//\r\n\t\t\t//\t\trCN - relation compressed name\r\n\t\t\t//\t\twithEntity - the same as rightEntity\r\n\t\t\t//\t    verb - leftEntity <verb> rightEntity ex. \"has\"\r\n\t\t\t//\t\tcardinality - leftEntity <verb><cardinality> rightEntity ex. \"zero or many\"\r\n\t\t\t//\t\tside - only for Nico's use - convention when  relation was created with relation.add in server side\r\n\t\t\t//\t\tstoredHere - only for Nico's use - Permission to save defined when  relation was created with relation.add in server side\r\n\t\t\t//\r\n\t\t\t//\t\tmock up for next version of dictionary --> t stands for temporary --> general format FL.dd.t.entities\r\n\t\t\t//\t\t\tFL.dd.t.entities.add(singular,description) - creates a new entity in dictionary\r\n\t\t\t//\t\t\tFL.dd.t.entities.dumpToConsole() - dump the whole dictionary to console\r\n\t\t\t//\t\t\tFL.dd.t.entities.list() - returns an array with all entity names (singular) in the dictionary\r\n\t\t\t//\t\t\tFL.dd.t.entities.getCName(<entityName>) - returns the compressed name of a singular entity name or null if it does not exist\r\n\t\t\t//\r\n\t\t\t//\t\t\tFL.dd.t.entities[<entity Compressed Name>].<property> - returns the property (singular,plural or description) of that eCN\r\n\t\t\t//\t\t\tFL.dd.t.entities[<entity Compressed Name>].set(options) - sets one or several properties (singular,plural or description)\r\n\t\t\t//\t\t\t\t\t\tExample FL.dd.t.entities[\"53\"].set({singular:\"subContractor\",plural:\"subContractors\",description:\"company subcontracted\"})\r\n\t\t\t//\t\t\t\r\n\t\t\t//\t\t\tFL.dd.t.entities[<entity Compressed Name>].fieldsList() - returns an array where each item has field properties\r\n\t\t\t//\t\t\t\tname,description,label,statment,type,typeUI,enumerable) of that eCN\r\n\t\t\t//\t\t\t\tExample\t\t\t\t\t\t\r\n\t\t\t//\t\t\t\t\tvar entity =\"sub\";\r\n\t\t\t//\t\t\t\t\tvar eCN = FL.dd.t.entities.getCName(entity);\r\n\t\t\t//\t\t\t\t\tvar display=null;\r\n\t\t\t//\t\t\t\t\t_.each(FL.dd.t.entities[eCN].fieldsList(),function(element){display+=element.name+\":::\"+element.description+\"\\n\"});\r\n\t\t\t//\t\t\tFL.dd.t.entities[<entity Compressed Name>].addField(name,descriptiom,label,type,typeUI,enumerable) - creates a new field for the entity\r\n\t\t\t//\t\t\t\tExample: \r\n\t\t\t//\t\t\t\t\tvar eCN = FL.dd.t.entities.getCName(entity);\r\n\t\t\t//\t\t\t\t\tFL.dd.t.entities[eCN].addField(\"joakim\",\"dummy field joakim\",\"Joakim'label\",\"text\",\"textbox\");\r\n\r\n\t\t\t//\t\t\tFL.dd.t.entities[<eCN>].getFieldCName(<fieldName>) - returns the compressed name of a singular field name or null if it does not exist\r\n\t\t\t//\t\t\t\t\t\tExample var fCN = FL.dd.t.entities[\"53\"].getCName(\"id\");\r\n\t\t\t//\t\t\tFL.dd.t.entities[<eCN>].fields[<fCN>].<property> - returns the field properties \r\n\t\t\t//\t\t\t\t(name,description,label,type,typeUI,enumerable) of that fCN\r\n\t\t\t//\t\t\t\tExample: FL.dd.t.entities[eCN].fields[fCN].name\r\n\r\n\t\t\t//\r\n\r\n\t\t\t//      \r\n\t\tvar getCompressed = function ( iGenNext ) { //returns a 2 bytes string from number \r\n\t\t\tvar sOut=\"\";\r\n\t\t\t//-------------\r\n\t\t\tvar iMinLen=2;\r\n\t\t\tvar sGenChars=\"0123456789aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ_\";\r\n\t\t\t//---------------------------------------------------------\r\n\t\t\t// Test using small character sets :\r\n\t\t\t// var sGenChars=\"01\"; // generates a binary represenntation with only '0' and '1' symbols\r\n\t\t\t//   or \r\n\t\t\t// var sGenChars=\"abc\";\r\n\t\t\t//-------------------------------------\r\n\t\t\tvar iGenCharLength= sGenChars.length;\r\n\t\t\t\r\n\t\t\tvar ii= iGenNext;\r\n\t\t\twhile ( ii >0 ) {\r\n\t\t\t\tvar iPos= ii % iGenCharLength;\r\n\t\t\t\tvar ch= sGenChars.substr( iPos, 1);\r\n\t\t\t\tsOut+= ch;\r\n\t\t\t\tii= Math.floor( ii / iGenCharLength);\r\n\t\t\t}\r\n\t\t\tii=sOut.length;\r\n\t\t\twhile (ii< iMinLen) {\r\n\t\t\t\tsOut+= sGenChars.substr( 0, 1);\r\n\t\t\t\tii++;\r\n\t\t\t}\r\n\t\t\t//---------\r\n\t\t\tsOut=  strReverse( sOut);\r\n\t\t\treturn sOut;\r\n\t\t};\r\n\t\tvar strReverse=function ( str ) {//reverse a string: ex: \"abcd\" becomes \"dcba\"\r\n\t\t\tvar sOut=\"\";\r\n\t\t\tvar iLen=str.length;\r\n\t\t\tfor (var ii=iLen-1; ii>=0; ii--) {\r\n\t\t\t\tsOut+= str.substr(ii,1);\r\n\t\t\t}\r\n\t\t\treturn sOut;\r\n\t\t};\r\n\t\tvar preArticle = function(sWord,xLanguage) {//for language xLanguage extract the article to be used before sWord\r\n\t\t\t//Ex z=\"What is \"+dDictionary.preArticle(xEntity,\"En\")+\"?\";\r\n\t\t\tif(!sWord)\r\n\t\t\t\treturn null;\r\n\t\t\tvar trad={ \"En\":\"a\",\"Fr\":\"un\",\"Pt\":\"um\",\"Nl\":\"een\"};\r\n\t\t\tvar xArticle=trad[xLanguage];\r\n\t\t\tvar xFirst=sWord.substr(0,1);\r\n\t\t\tvar xLen=sWord.length;\r\n\t\t\tvar xLast=sWord.substr(xLen-1,1);\r\n\r\n\t\t\tswitch(xLanguage){\r\n\t\t\t\tcase \"En\":\r\n\t\t\t\t\tif((\"aeiou\").indexOf(xFirst)>=0) //if first letter is one of\r\n\t\t\t\t\t\txArticle=\"an\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Fr\":\r\n\t\t\t\t\tvar xLast2=sWord.substr(xLen-2,2);\r\n\t\t\t\t\tif((\"e ie t\").indexOf(xLast2)>=0)\r\n\t\t\t\t\t\txArticle=\"une\";\r\n\t\t\t\t\tvar xLast3=sWord.substr(xLen-3,3);\r\n\t\t\t\t\tif((\"ade eur rie re ine ise ose ole ure\").indexOf(xLast3)>=0)\r\n\t\t\t\t\t\txArticle=\"une\";\r\n\t\t\t\t\tvar xLast4=sWord.substr(xLen-4,4);\r\n\t\t\t\t\tif((\"aille ison sion tion ance asse te ence euse elle esse ette\").indexOf(xLast3)>=0)\r\n\t\t\t\t\t\txArticle=\"une\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Pt\":\r\n\t\t\t\t\tif(xLast==\"a\")\r\n\t\t\t\t\t\txArticle=\"uma\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn xArticle+\" \"+sWord;\r\n\t\t};\t//preArticle\t\t\t\r\n\t\tvar plural = function(sWord,xLanguage) {//returns the plural of sWord in language=xLanguage\r\n\t\t\t//ex: dDictionary.plural(\"car\",\"En\") ->cars, dDictionary.plural(\"box\",\"En\")->boxes \r\n\t\t\tvar xWord=sWord;\r\n\t\t\tvar xFirst=sWord.substr(0,1);\r\n\t\t\tvar xLen=sWord.length;\r\n\t\t\tvar xLast=sWord.substr(xLen-1,1);\r\n\t\t\tvar xLast2=sWord.substr(xLen-2,2);\r\n\t\t\tvar xLast3=sWord.substr(xLen-3,3);\r\n\r\n\t\t\tswitch(xLanguage){\r\n\t\t\t\tcase \"En\":\r\n\t\t\t\t\t// var xLast2=sWord.substr(xLen-2,2);\r\n\t\t\t\t\tif((\"x\").indexOf(xLast)>=0){ //if last char is one of\r\n\t\t\t\t\t\txWord=xWord+\"es\";//box->boxes\r\n\t\t\t\t\t}else if((\"y\").indexOf(xLast)>=0){ //if last chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-1)+\"ies\";//city ->cities\r\n\t\t\t\t\t}else if((\"ch to ro\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord+\"es\";//switch ->switches tomato->tomatoes hero->heroes\r\n\t\t\t\t\t\tif((\"disco piano photo\").indexOf(sWord)>=0)//exceptions to the above rule\r\n\t\t\t\t\t\t\txWord=sWord+\"s\";\r\n\t\t\t\t\t}else if((\"fe\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-2)+\"ves\";//wife ->wives\r\n\t\t\t\t\t}else if((\"lf\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-1)+\"ves\";//shelf->shelves\r\n\t\t\t\t\t}else{//remaining cases\r\n\t\t\t\t\t\txWord=xWord+\"s\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//irregular forms\r\n\t\t\t\t\tvar oIrr={man:\"men\",woman:\"women\",child:\"children\",mouse:\"mice\",teeth:\"tooth\",goose:\"geese\",foot:\"feet\",ox:\"oxen\"};\r\n\t\t\t\t\txIrr=oIrr[sWord];\r\n\t\t\t\t\tif(xIrr)\r\n\t\t\t\t\t\txWord=xIrr;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Fr\":\r\n\t\t\t\t\t// xLast2=sWord.substr(xLen-2,2);\r\n\t\t\t\t\tif((\"xs\").indexOf(xLast)>=0){ //if last char is one of\r\n\t\t\t\t\t\txWord=xWord;//prix->prix gros->gros\r\n\t\t\t\t\t}else if((\"al\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-1)+\"ux\";//jornal -> jornaux\r\n\t\t\t\t\t}else if((\"au eu\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord+\"x\";//chateu ->chateux, jeu -> jeux\r\n\t\t\t\t\t}else{//remaining cases\r\n\t\t\t\t\t\txWord=xWord+\"s\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Pt\":\r\n\t\t\t\t\t// var xLast2=sWord.substr(xLen-2,2);\r\n\t\t\t\t\t// var xLast3=sWord.substr(xLen-3,3);\r\n\t\t\t\t\tif((\"rsz\").indexOf(xLast)>=0){ //if last char is one of\r\n\t\t\t\t\t\txWord=xWord+\"es\";//cor->cores, chafariz->chafarizes mes->meses\r\n\t\t\t\t\t}else if((\"al el il ol\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-1)+\"is\";//sinal->sinais papel->papeis barril->barris lencol->lencois\r\n\t\t\t\t\t}else if((\"cao iao\").indexOf(xLast3)>=0){ //if last 3 chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-2)+\"oes\";//organizao->organizaes, avio->avies \r\n\t\t\t\t\t}else if((\"ao\").indexOf(xLast2)>=0){ //if last 2 chars are one of\r\n\t\t\t\t\t\txWord=xWord.substr(0,xLen-1)+\"es\";//po->pes\r\n\t\t\t\t\t}else{//remaining cases\r\n\t\t\t\t\t\txWord=xWord+\"s\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Nl\":\r\n\t\t\t\t\t// var xLast2=sWord.substr(xLen-2,2);\r\n\t\t\t\t\t// var xLast3=sWord.substr(xLen-3,3);\r\n\t\t\t\t\tif((\"aeiou\").indexOf(xLast)>=0){ //if last char is one of (vowel) plural is +en, +s or 's\r\n\t\t\t\t\t\txWord=xWord+\"s\";//radio->radios, ziekte->ziektes \t\r\n\t\t\t\t\t\tif((\"bekende gepensioneerde werkende\").indexOf(sWord)>=0)//exceptions to the above rule\r\n\t\t\t\t\t\t\t\txWord=sWord+\"n\";\r\n\t\t\t\t\t}else{//end in consonant\r\n\t\t\t\t\t\tif((\"kl\").indexOf(xLast)>=0){ //if last chars are one of\r\n\t\t\t\t\t\t\txWord=xWord+xLast+\"en\";//rok->rokken, geval->gevallen\r\n\t\t\t\t\t\t}else if((\"el em en er um rd\").indexOf(xLast2)>=0){ //if last chars are one of\r\n\t\t\t\t\t\t\txWord=xWord+\"s\";//keuken->keukens\r\n\t\t\t\t\t\t}else if((\"eur oon oor ier\").indexOf(xLast3)>=0){ //if last chars are one of\r\n\t\t\t\t\t\t\txWord=xWord+\"s\";//monteur ->monteurs\r\n\t\t\t\t\t\t}else if((\"f\").indexOf(xLast)>=0){ //if last chars are one of\r\n\t\t\t\t\t\t\txWord=xWord.substr(0,xLen-1)+\"ven\";//brief ->brieven\r\n\t\t\t\t\t\t}else{//remaining cases\r\n\t\t\t\t\t\t\txWord=xWord+\"en\";//boek->boeken\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn xWord;\r\n\t\t};//plural\r\n\t\tvar makeSemStr= function(x1,x2,xType,xLanguage) {//concatenate basic entity semantics\r\n\t\t// x1 - first word (pre) to be connected to second by phrase of type=xType\r\n\t\t// x2 - second word (pos) to be connected to first by phrase of type=xType\r\n\t\t// xType:\r\n\t\t//     \"A\" - \"Definition statement\" - singular-description x1=singular and x2=description\r\n\t\t//\t\tuse: dDictionary.makeSemStr(\"Client\",\"Individual or Company to whom we may send invoices\",\"A\",\"En\") to get:\r\n\t\t//\t\t\t<Client> is a <Individual or Company to whom we may send invoices>\r\n\t\t//     \"B\" - \"plural statement\" singular-plural x1=singular and x2=plural\r\n\t\t//\t\tuse: dDictionary.makeSemStr(\"Client\",\"clients\",\"B\",\"En\") to get:\r\n\t\t//\t\t\t\tA set with more than one <Client> is called a set of <clients>\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t\tvar trad = { //semantinc repository\r\n\t\t\t\t\"En\":{A:{pre:\"\",mid:\" is a(n) \",pos:\"\"},B:{pre:\"A set with more than one \",mid:\" is called a set of \",pos:\"\"}},\r\n\t\t\t\t\"Fr\":{A:{pre:\"\",mid:\" c'est un \",pos:\"\"},B:{pre:\"Un group avec plus q'un \",mid:\" s'appelle un groupe de \",pos:\"\"}},\r\n\t\t\t\t\"Nl\":{A:{pre:\"\",mid:\" is een \",pos:\"\"},B:{pre:\"Een set met meer dan n \",mid:\" is een set van \",pos:\"\"}},\r\n\t\t\t\t\"Pt\":{A:{pre:\"\",mid:\"  um \",pos:\"\"},B:{pre:\"Um grupo com mais do que um \",mid:\" designa-se por grupo de \",pos:\"\"}}\r\n\t\t\t};\r\n\t\t\tvar oTrad=trad[xLanguage][xType];\r\n\t\t\tvar sRet=oTrad.pre+x1+oTrad.mid+x2+oTrad.pos;\r\n\t\t\treturn sRet;\r\n\t\t}; //makeSemStr\r\n\t\tvar entitySemantics= function(oEntity,xType,xLanguage) {//shows entity/description semantics\r\n\t\t// return (case \"A\") --> <Client> is a <Individual or Company to whom we may send invoices>\r\n\t\t// ex: if(this.oDbg.isDbg(\"main\")) this.oDbg.display(\"Semantics 1)->\"+dDictionary.entitySemantics(oEntity,\"A\",\"En\"));\r\n\t\t// ex: if(this.oDbg.isDbg(\"main\")) this.oDbg.display(\"Semantics 2)->\"+dDictionary.entitySemantics(oEntity,\"B\",\"En\"));\r\n\t\t//     A set with more than one <Client> is called a set of <clients>\r\n\t\t\tvar xRet=null;\r\n\t\t\tif(xType==\"A\"){\r\n\t\t\t\txRet = makeSemStr(oEntity.singular,oEntity.description,\"A\",\"En\");\r\n\t\t\t}else if(xType==\"B\"){\r\n\t\t\t\txRet = makeSemStr(oEntity.singular,oEntity.plural,\"B\",\"En\");\r\n\t\t\t}else{\r\n\t\t\t\talert(\"dDictionary.entitySemantics Parameter xType=\"+xType+\" is unsupported !!!\");\r\n\t\t\t\t//Err.alert(\"dDictionary.entitySemantics\",(new Error),\"Parameter xType=\"+xType+\" is unsupported !!!\");\r\n\t\t\t}\r\n\t\t\treturn xRet;\r\n\t\t}; //entitySemantics\r\n\t\tvar attributeSemantics= function(xAttribute,xAttrDescription,oEntity,xLanguage) {//shows singular-description for attribute=xAttribute\r\n\t\t// ex: The <address> of <Client> is <the address to send invoices>\r\n\t\t//  dDictionary.attributeSemantics(oEntity.attributes[i].name,oEntity.attributes[i].description,oEntity,\"En\");\r\n\t\t\tvar trad={ //entity+A+description, B.pre+singular+B.mid+plural+B.pos\r\n\t\t\t\t\"En\":{pre:\"The \",mid1:\" of \",mid2:\" is \",pos:\"\"},\r\n\t\t\t\t\"Fr\":{pre:\"Le \",mid1:\" du \",mid2:\" c'est \",pos:\"\"},\r\n\t\t\t\t\"Nl\":{pre:\"Het \",mid1:\" van de \",mid2:\" is het \",pos:\"\"},\r\n\t\t\t\t\"Pt\":{pre:\"\",mid1:\" do \",mid2:\"  \",pos:\"\"}\r\n\t\t\t};\r\n\t\t\tvar oLanguage=trad[xLanguage];//extracts language code\r\n\t\t\treturn oLanguage.pre+xAttribute+oLanguage.mid1+oEntity.singular+oLanguage.mid2+xAttrDescription+oLanguage.pos;\r\n\t\t};//attributeSemantics\r\n\t\tvar reversePhrase_is_something = function(sVerb){\r\n\t\t//\t\tbook \"is published by\" an editor--> editor \"publishes\" many books\r\n\t\t\tvar xArr=sVerb.split(\" \");\r\n\t\t\tvar xLen=xArr[1].length;//length of second word (supposedly a verb)\r\n\t\t\tvar xLast=xArr[1].substr(xLen-2,2);//last 2 chars (ed)\r\n\t\t\t// if(xLast==\"ed\")\r\n\t\t\t\tvar xRet=xArr[1].substr(0,xLen-2)+\"es\";//publishes\t\t\t\t\t\t\t\r\n\t\t\treturn xRet;\r\n\t\t};\r\n\t\tvar invertedToOneVerb = function(sVerb,xLanguage){//returns verb of inverted relation of sVerb\r\n\t\t// this method computes the passive voice for the verb in \"To One\" sentences (3rd person)\r\n\t\t//\t\tInvoice Line  \"has\" one product --> product \"is referred by\" many Incoice Lines\r\n\t\t//\t\tInvoice \"invoices\" one client\t--> client \"is invoiced by\" many invoices\r\n\t\t//\t\treserve \"is done by\" one member\t--> member \"does \" many reserves\r\n\t\t//\t\tbook \"has\" genre                --> genre \"is referred by\" many books (or classifies) \r\n\t\t//\t\tbook \"is published by\" an editor--> editor \"publishes\" many books\r\n\t\t//\t\teditor \"publishes\" one title   --> title  \"is published by\" many editors\r\n\t\t//\t\ttrip \"visits\" one destination   --> destination \"is visited by\" many trips\r\n\t\t//\r\n\t\t//\t\tsalesRep \"is responsable by complaints of \" many clients --> client \"complaints to\" one salesRep\r\n\t\t//\r\n\t\t//   sVerb - verb in the direct \"To One\" relation (left side examples)\r\n\t\t//   RETURN: inverted relation verb (rigth side examples)\r\n\t\t//     Example: \"visits\" becomes \"is visited by\"\r\n\t\t//           the inverse relation becomes-> destination is visited by zero or many trips\r\n\t\t// Tests\r\n\t\t// xPre=\"reserve\";xIn=\"is done by\";xPos=\"member\";\r\n\t\t// var xOut=dDictionary.invertedToOneVerb(xIn,\"En\");\r\n\t\t// FL.common.printToConsole(xPre+\" \"+xIn+\" one \"+xPos+\" ->\"+xPos+\" \"+xOut+\" many \"+dDictionary.plural(xPre,\"En\"));\r\n\t\t\tvar DirDefault = {\"En\":{\"default\":\"is referred by\",\"has\":\"is referred by\",\"is done by\":\"does\"},\r\n\t\t\t\t\t\t\t\t\"Fr\":{\"default\":\"appartient a\",\"a\":\"appartient a\"},\r\n\t\t\t\t\t\t\t\t\"Pt\":{\"default\":\"pertence a\",\"tem\":\"pertence a\"},\r\n\t\t\t\t\t\t\t\t\"Nl\":{\"default\":\"wordt verwezen\",\"heeft\":\"wordt verwezen\"}\r\n\t\t\t\t\t\t\t};\r\n\t\t\t//var InvDefault ={ \"En\":{\"referres\":\"is referred by\"},\"Fr\":{\"a\":\"appartiennent\"},\"Pt\":{\"tem\":\"pertence a\"},\"Nl\":{\"heeft\":\"wordt verwezen\"};\r\n\t\t\tvar oObj = DirDefault[xLanguage];\r\n\t\t\tvar xRet = null;\r\n\t\t\tif(oObj){\r\n\t\t\t\tfor (var key in oObj) {\r\n\t\t\t\t\tif (oObj.hasOwnProperty(key)) {\r\n\t\t\t\t\t\tif(key==sVerb)\r\n\t\t\t\t\t\t\txRet=oObj[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(xRet)\r\n\t\t\t\treturn xRet;\r\n\t\t\tvar xLen=sVerb.length;\r\n\t\t\tvar xArr=sVerb.split(\" \");\r\n\t\t\tvar xLast = null;\r\n\t\t\tvar xLast2 = null;\r\n\t\t\tswitch(xLanguage){\r\n\t\t\t\tcase \"En\":\r\n\t\t\t\t\tif(xArr.length>1){//more than one word\r\n\t\t\t\t\t\tif(xArr.length>3){\r\n\t\t\t\t\t\t\tif(xArr[1] == \"responsable\" && xArr[2] == \"by\" ){//\"it begins by is responsable by\" Ex:\"is responsable by complaints\"\r\n\t\t\t\t\t\t\t\txRet=xArr[3]+\" to\";//returns \"complaints to\"\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\txRet=reversePhrase_is_something(sVerb);\r\n\t\t\t\t\t\t\t}\t\t\r\n\t\t\t\t\t\t}else if(xArr[0]==\"is\"){ //\"is published by\" ->publishes <> \"is managed by\" ->manages\r\n\t\t\t\t\t\t\txRet=reversePhrase_is_something(sVerb);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else if(xArr.length==1){ //one single word -> \"publishes\" ->\"is published by\", \"visits\"->\"is visited by\" \r\n\t\t\t\t\t\txLen=xArr[0].length;\r\n\t\t\t\t\t\txLast=xArr[0].substr(xLen-1,1);//last 1 chars (s)\r\n\t\t\t\t\t\txLast2=xArr[0].substr(xLen-2,2);//last 2 chars (s)\r\n\t\t\t\t\t\tif(xLast2==\"es\"){//\"publishes\" ->\"is published by\"\r\n\t\t\t\t\t\t\txRet=\"is \"+xArr[0].substr(0,xLen-2)+\"ed by\";\r\n\t\t\t\t\t\t}else if(xLast==\"s\"){//\"visits\"->\"is visited by\" \r\n\t\t\t\t\t\t\txRet=\"is \"+xArr[0].substr(0,xLen-1)+\"ed by\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Pt\":\r\n\t\t\t\t\tif(xArr.length>1){//more than one word\r\n\t\t\t\t\t\tif(xArr[0]==\"\"){ //\" publicado por \" ->publica\r\n\t\t\t\t\t\t\txLen=xArr[1].length;\r\n\t\t\t\t\t\t\tvar xLast3=xArr[1].substr(xLen-3,3);//last 2 chars (ed)\r\n\t\t\t\t\t\t\tif(xLast3==\"ado\")\r\n\t\t\t\t\t\t\t\txRet=xArr[1].substr(0,xLen-3)+\"a\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else if(xArr.length==1){ //one single word -> \"publica\" ->\" publicado por\", \"visita\"->\" visitado por\" \r\n\t\t\t\t\t\txLen=xArr[0].length;\r\n\t\t\t\t\t\txLast=xArr[0].substr(xLen-1,1);//last 1 chars (s)\r\n\t\t\t\t\t\txLast2=xArr[0].substr(xLen-2,2);//last 2 chars (s)\r\n\t\t\t\t\t\tif(xLast2==\"xx\"){//\"to be done\"\r\n\t\t\t\t\t\t\txRet=\"is \"+xArr[0].substr(0,xLen-2)+\"ed by\";\r\n\t\t\t\t\t\t}else if(xLast==\"a\"){//\"visita\"->\"is visited by\"\r\n\t\t\t\t\t\t\txRet=\" \"+xArr[0]+\"do por\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}//end switch\r\n\t\t\tif(!xRet)\r\n\t\t\t\txRet=oObj[\"default\"];\r\n\t\t\treturn xRet;\r\n\t\t}; //invertedToOneVerb\t\t\t\r\n\t\tvar cardinalityDecoder=function(sCardinality,xLanguage){//returns semantics to Cardinality - object {cardText:<string or null>,cardPlural:<boolean>}\r\n\t\t\t//returns and object with {cardText:<string or null>,cardPlural:<boolean>}\r\n\t\t\t//   cardText contains the expression corresponding to the code=sCardinality in the language=xLanguage\r\n\t\t\t//\t\t if cardinality does not exist - cardText will be null - working as a validator\r\n\t\t\t//   cardPlural - contains a boolean such as:\r\n\t\t\t//\t\t if cardinality implies a second member singular in relation semantics - cardPlural will be false\r\n\t\t\t//\t\t if cardinality implies a second member plural in relation semantics - cardPlural will be true\r\n\t\t\t//\t\t  ex:in expression - \"Invoice Item\" \"belongs to\" \"one and only one\" \"Invoice\" ->second member is singular\r\n\t\t\t//\t\t    :in expression - \"Client\" \"has\" \"many\" \"Invoices\"\t\t\t\t\t\t  ->second member is plural\r\n\t\t\tvar trad={ //entity+A+description, B.pre+singular+B.mid+plural+B.pos\r\n\t\t\t\t\"En\":{\"1\":{text:\"zero or 1\",cardPlural:false},\"N\":{text:\"many\",cardPlural:true},\"1\":{text:\"one and only one\",cardPlural:false}},\r\n\t\t\t\t\"Fr\":{\"1\":{text:\"zero ou 1\",cardPlural:false},\"N\":{text:\"plusieurs\",cardPlural:true},\"1\":{text:\"un et seulement un\",cardPlural:false}},\r\n\t\t\t\t\"Nl\":{\"1\":{text:\"nul of 1\",cardPlural:false},\"N\":{text:\"velen\",cardPlural:true},\"1\":{text:\"slechts n\",cardPlural:false}},\r\n\t\t\t\t\"Pt\":{\"1\":{text:\"zero ou 1\",cardPlural:false},\"N\":{text:\"varios\",cardPlural:true},\"1\":{text:\"um e apenas um\",cardPlural:false}},\r\n\t\t\t};\r\n\t\t\tvar oLanguage=trad[xLanguage];//extracts language code\r\n\t\t\txCardText=null;\r\n\t\t\txCardPlural=false;\r\n\t\t\tif(oLanguage){//the quest is for a known language\r\n\t\t\t\tvar xDecoder=oLanguage[sCardinality];\r\n\t\t\t\tif(xDecoder){\r\n\t\t\t\t\txCardText=xDecoder.text;\r\n\t\t\t\t\txCardPlural=xDecoder.cardPlural;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {cardText:xCardText,cardPlural:xCardPlural};//if cardiality does not exist cardText will return null\r\n\t\t};//cardinalityDecoder\t\t\r\n\t\tvar relationSemantics= function(sSingular,sRightEntity,sVerb,sCardinality,xLanguage) {//shows relationsemantics\r\n\t\t// ex for : sSingular=\"Client\",sRightEntity=\"Invoice\",sVerb=\"has\",sCardinality=\"0_N\",xLanguage=\"En\"\r\n\t\t// \t  returns : \"Client has many invoices\"\r\n\t\t//  dDictionary.attributeSemantics(oEntity.attributes[i].name,oEntity.attributes[i].description,oEntity,\"En\");\r\n\t\t\tvar xRet=sSingular+\" \"+sVerb+\" \";\r\n\t\t\tvar oCard=cardinalityDecoder(sCardinality,xLanguage);\r\n\t\t\tif(!oCard.cardText){\r\n\t\t\t\talert(\"relationSemantics - Impossible to find semantics for cardinality=\"+sCardinality+\" Language=\"+xLanguage);\r\n\t\t\t\t//Err.alert(\"dDictionary.relationSemantics\",(new Error),\"Impossible to find semantics for cardinality=\"+sCardinality+\" Language=\"+xLanguage);\r\n\t\t\t}\r\n\t\t\txRet+=oCard.cardText+\" \";\r\n\t\t\tvar xRight=sRightEntity;//this will be the singular for thew right entity\r\n\t\t\tif(oCard.cardPlural){\r\n\t\t\t\txRight=FL.dd.entities[sRightEntity].plural;\r\n\t\t\t\tif(!xRight){\r\n\t\t\t\t\talert(\"relationSemantics - RightEntity=\"+sRightEntity+\" does not exist in Data Dictionay\");\r\n\t\t\t\t\t//Err.alert(\"dDictionary.relationSemantics\",(new Error),\"RightEntity=\"+sRightEntity+\" does not exist in Data Dictionay\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn xRet+xRight;\r\n\t\t}; //relationSemantics\t\t\t\r\n\t\tvar attributeIndex= function(xSingular,xAttribute) {//for entity=xSingular, returns the index of attribute=xAttribute\r\n\t\t\t// if attribute exists within xSingular returns it. Returns -1 otherwise\r\n\t\t\t// FL.common.printToConsole(\"dd.attributeIndex ->check index for \"+xAttribute);\r\n\t\t\tvar xRet = -1;\r\n\t\t\tvar oEntity = FL.dd.entities[xSingular];\r\n\t\t\tif(oEntity){\r\n\t\t\t\tvar xArr = oEntity.attributes;\r\n\t\t\t\tif(xArr.length>0){\r\n\t\t\t\t\t// FL.common.printToConsole(\"-------------- dd.attributeIndex  existing attribute names ------------BEGIN\");\r\n\t\t\t\t\tfor (var i=0;i<xArr.length;i++){\r\n\t\t\t\t\t\t// FL.common.printToConsole(xArr[i].name);\r\n\t\t\t\t\t\tif (xArr[i].name==xAttribute) {\r\n\t\t\t\t\t\t\txRet=i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// FL.common.printToConsole(\"-------------- dd.attributeIndex  existing attribute names ------------END\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tFL.common.printToConsole(\"FL.dd.attributeIndex ->no attributes defined !\");\r\n\t\t\t\t}\r\n\t\t\t\t// FL.common.printToConsole(\"dd.attributeIndex ->for attribute=\"+xAttribute+\" returns position=\"+xRet);\r\n\t\t\t}\r\n\t\t\treturn xRet;\r\n\t\t};//attributeIndex\r\n\t\tvar prepareRelation = function(xSingular,rCN,withEntityName,verb,cardinality,side,storedHere,xLanguage){//prepare JSON to relation arr - used by FL.dd.addRelation()\r\n\t\t\tvar relation = {};\r\n\t\t\trelation[\"rCN\"] = rCN;\r\n\t\t\trelation[\"withEntity\"] = withEntityName;\r\n\t\t\trelation[\"verb\"] = verb;\r\n\t\t\trelation[\"cardinality\"] = cardinality;\r\n\t\t\tif(!side)\r\n\t\t\t\tside = null;\r\n\t\t\tif(!storedHere)\r\n\t\t\t\tstoredHere = null;\r\n\t\t\trelation[\"side\"] = side;\r\n\t\t\trelation[\"storedHere\"] = storedHere;\r\n\t\t\t// var rightEntityName = \r\n\t\t\tvar xSemantics=FL.dd.relationSemantics(xSingular,withEntityName,verb,cardinality,xLanguage);\r\n\r\n\t\t\trelation[\"semantic\"] = xSemantics;\r\n\r\n\t\t\trelation[\"side\"] = side;\r\n\t\t\trelation[\"storedHere\"] = storedHere;\r\n\t\t\trelation[\"withEntityCN\"] = null;//this is an auxiliary field to support FL.server.syncLocalDictionary()\r\n\t\t\treturn relation;\r\n\t\t};\r\n\t\tvar getDictAttributesBackup = function(attrArr){//returns a copy of an attributes Array (to be used by getDictEntityBackup)\r\n\t\t\tvar backupArr = _.map(attrArr, function(element){\r\n\t\t\t\tvar eNumBackup = _.clone(element.enumerable);\r\n\t\t\t\tvar elBackup = _.clone(element);\r\n\t\t\t\telBackup.enumerable = eNumBackup;\r\n\t\t\t\treturn(elBackup);\r\n\t\t\t});\r\n\t\t\treturn backupArr;\r\n\t\t};\r\n\t\treturn{\r\n\t\t\tentities: {__Last:9999,__LastRelation:0},\r\n\t\t\ttest:\"FL.dd.test return !!!\",\r\n\t\t\tpreArticle: function(sWord,xLanguage) {//for language xLanguage extract the article to be used before sWord\r\n\t\t\t\t//Ex z=\"What is \"+dDictionary.preArticle(xEntity,\"En\")+\"?\";\r\n\t\t\t\treturn preArticle(sWord,xLanguage);\r\n\t\t\t},\r\n\t\t\tplural: function(sWord,xLanguage) {//returns the plural of sWord in language=xLanguage\t\t\t\t\r\n\t\t\t\treturn plural(sWord,xLanguage);\r\n\t\t\t},\r\n\t\t\tclear: function(){\r\n\t\t\t\tthis.entities = {__Last:9999,__LastRelation:0};\r\n\t\t\t},\r\n\t\t\trelationSemantics: function(sSingular,sRightEntity,sVerb,sCardinality,xLanguage) {\r\n\t\t\t\treturn relationSemantics(sSingular,sRightEntity,sVerb,sCardinality,xLanguage);\r\n\t\t\t},\r\n\t\t\tdisplayEntities: function(){//display all entities with their attributes and relations\r\n\t\t\t\t//Reads dDictionary.entities={} and \r\n\t\t\t\t//returns a collection of menu structure objects - {book:{},editor:{},..someEntity:{}}\r\n\t\t\t\t//the key of the internal objects are the singular entity name\r\n\t\t\t\t//   each internal object has: \r\n\t\t\t\t//\t\tkey:{singular:<key>,plural:<entity plural>,description:<entity description>}\t\r\n\t\t\t\t//based on  var oEntity=dDictionary.createEntity(\"Client\",\"clients\",\"Individual or Company to whom we may send invoices\");\r\n\t\t\t\t//each attribute (i) is in dDictionary.entities[<sEentity>].attributes[i]\r\n\t\t\t\t//     with the format \r\n\t\t\t\t//\t\t{name:\"address\",description:\"address to send invoices\",label:\"Address\",type:\"string\",enumerable:null,key:false});\r\n\t\t\t\t//\t\t\tNOTE: enumerable is null for all type except \"enumerable\" - in this case enumerable is an array of strings\r\n\t\t\t\t// \r\n\t\t\t\t// FL.API.debug = true;FL.API.debugStyle = 1;\r\n\t\t\t\tFL.common.printToConsole(\"********************************** FL.dd.displayEntities ********************************\",\"dump\");\r\n\t\t\t\tFL.common.printToConsole(\"********************************************** BEGIN ******************************************\",\"dump\");\r\n\r\n\t\t\t\tvar oEntities = this.entities;\r\n\t\t\t\tfor (var key in oEntities) {\r\n\t\t\t\t\tif (oEntities.hasOwnProperty(key)) {//this restrain the iteration only to the object's own attributes\r\n\t\t\t\t\t\tif(key==\"__Last\"){\r\n\r\n\t\t\t\t\t\t\tFL.common.printToConsole(\"(__Last) -> Number of entities in dictionary=\"+ (oEntities[key]-9999) ,\"dump\");\r\n\t\t\t\t\t\t}else if(key==\"__LastRelation\"){\r\n\t\t\t\t\t\t\tFL.common.printToConsole(\"(__LastRelation) -> Number of relations in dictionary=\"+oEntities[key],\"dump\");\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tFL.common.printToConsole(\"Entity=\"+oEntities[key].singular+\"/\"+oEntities[key].csingular +\" - Plural=\"+oEntities[key].plural+\"- description=\"+oEntities[key].description + \" sync=\"+oEntities[key].sync ,\"dump\");\r\n\t\t\t\t\t\t\t//now we display each attribute\r\n\t\t\t\t\t\t\tvar oL2C = oEntities[key].L2C;\r\n\t\t\t\t\t\t\tvar xArr = oEntities[key].attributes;\r\n\t\t\t\t\t\t\tif(xArr.length>0){//the entity has attribute(s)\r\n\t\t\t\t\t\t\t\tfor (var i=0;i<xArr.length;i++){\r\n\t\t\t\t\t\t\t\t\tvar xName=xArr[i].name;\r\n\t\t\t\t\t\t\t\t\tvar xCName=oL2C[xName];\r\n\t\t\t\t\t\t\t\t\tvar xDescr=xArr[i].description;\r\n\t\t\t\t\t\t\t\t\tvar xLabel=xArr[i].label;\r\n\t\t\t\t\t\t\t\t\tvar xType=xArr[i].type;\r\n\t\t\t\t\t\t\t\t\tvar xTypeUI=xArr[i].typeUI;\r\n\t\t\t\t\t\t\t\t\tvar xMask=xArr[i].mask;\r\n\t\t\t\t\t\t\t\t\tvar xSpecialTypeDef=xArr[i].specialTypeDef;\r\n\t\t\t\t\t\t\t\t\tif(FL.common.typeOf(xSpecialTypeDef) == \"object\")\r\n\t\t\t\t\t\t\t\t\t\txSpecialTypeDef = JSON.stringify(xSpecialTypeDef);\r\n\t\t\t\t\t\t\t\t\tvar xKey=xArr[i].key;\r\n\t\t\t\t\t\t\t\t\tvar xEnumerable=xArr[i].enumerable;\r\n\t\t\t\t\t\t\t\t\t// FL.common.printToConsole(\"-----> attribute[\"+i+\"]=\"+xName+\"/\"+xDescr+\"/\"+xCName+\",key=\"+xKey+\",type=\"+xType);\r\n\t\t\t\t\t\t\t\t\tFL.common.printToConsole(\"-----> attribute[\"+i+\"]=\"+xName+\"/\"+xDescr+\"/\"+xCName+\",label=\"+xLabel+\",key=\"+xKey+\",type=\"+xType+\",typeUI=\"+xTypeUI+\",mask=\"+xMask+\",specialTypeDef=\"+xSpecialTypeDef,\"dump\");\r\n\t\t\t\t\t\t\t\t\tif(xEnumerable) {\r\n\t\t\t\t\t\t\t\t\t\tfor (var j=0;j<xEnumerable.length;j++){\r\n\t\t\t\t\t\t\t\t\t\t\tFL.common.printToConsole(\"------------> enumerable[\"+j+\"]=\"+xEnumerable[j],\"dump\");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tFL.common.printToConsole(\"----->no attributes defined !\",\"dump\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\txArr=oEntities[key].relations;\r\n\t\t\t\t\t\t\tif(xArr.length>0){//the entity has attribute(s)\r\n\t\t\t\t\t\t\t\tfor (var i=0;i<xArr.length;i++){\r\n\t\t\t\t\t\t\t\t\t// var xCIdRelation=xArr[i].cIdRelation;\r\n\t\t\t\t\t\t\t\t\tvar xSemantic=xArr[i].semantic;\r\n\t\t\t\t\t\t\t\t\t// var xCard=xArr[i].cardinality;\r\n\t\t\t\t\t\t\t\t\tvar rCN = xArr[i].rCN;\r\n\t\t\t\t\t\t\t\t\tvar withEntity = xArr[i].withEntity;\r\n\t\t\t\t\t\t\t\t\tvar verb = xArr[i].verb;\r\n\t\t\t\t\t\t\t\t\tvar rCN = xArr[i].rCN;\r\n\t\t\t\t\t\t\t\t\tvar cardinality = xArr[i].cardinality;\r\n\t\t\t\t\t\t\t\t\tvar side = xArr[i].side;\r\n\t\t\t\t\t\t\t\t\tvar storeHere = xArr[i].storeHere;\r\n\r\n\t\t\t\t\t\t\t\t\tFL.common.printToConsole(\"-----> relation[\"+i+\"] with rCN=\"+rCN+\" -> \"+xSemantic+\" - #=\"+cardinality,\"dump\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tFL.common.printToConsole(\"----->no relations defined !\",\"dump\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tFL.common.printToConsole(\"********************************************** END of displayEntities *****************************************\",\"dump\");\r\n\t\t\t\t// FL.API.debug = false; FL.API.debugStyle = 0;\r\n\t\t\t},\r\n\t\t\tcountEntitiesBeginningBy: function(singularPrefix) {//return the number of entities whose singular name begins by singularPrefix\r\n\t\t\t\t//example   var count = FL.dd.countsEntitiesBeginningBy(\"_unNamed\");=>count = 0\r\n\t\t\t\tvar xRet = 0;\r\n\t\t\t\tvar lenOfEntityPrefix = singularPrefix.length;\r\n\t\t\t\tvar entities = this.entities;\r\n\t\t\t\t_.each(entities, function(value,key){// If list is a JavaScript object, iterator's arguments will be (value, key, list)\r\n\t\t\t\t\tif(key.substring(0,lenOfEntityPrefix) == singularPrefix) {\r\n\t\t\t\t\t\txRet++;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn xRet;\r\n\t\t\t},\r\n\t\t\tnextEntityBeginningBy: function(singularPrefix) {//proposes a name \r\n\t\t\t\t//example   var nextUnNamed = FL.dd.nextEntityBeginningBy(\"unNamed\");\r\n\t\t\t\t//   if there is no entity  begginning by unNamed --> returns \"unNamed\"\r\n\t\t\t\t//   if there is \"unNamed\"  --> returns \"unNamed1\"\r\n\t\t\t\t//   if there is \"unNamed1\"  --> returns \"unNamed2\"\r\n\t\t\t\tvar nextEntityName = singularPrefix;\r\n\t\t\t\tvar count = this.countEntitiesBeginningBy(singularPrefix);\r\n\t\t\t\tif(count>0){\r\n\t\t\t\t\tnextEntityName = singularPrefix + count;\r\n\t\t\t\t}\r\n\t\t\t\treturn nextEntityName;\r\n\t\t\t},\r\n\t\t\tcreateEntity: function(xSingular,xDescription) {//add an entity entry returning true if it succeeds false otherwise\r\n\t\t\t\t//   Whenever a new entity is created a key attribute is also created with:\r\n\t\t\t\t//\t\tdDictionary.addAttribute(xSingular,\"id\",xSingular+\"'s id\",\"textBox\",true);\r\n\t\t\t\t//      Note:The key attribute is glued to the entity - (it may be editable, but not deleted)\r\n\t\t\t\t//\t\t\tif the entity exists the key attribute also exist\r\n\t\t\t\t//\t\t\tit only can be removed if we remove the entity\r\n\t\t\t\t//   \r\n\t\t\t\t//ex. var oEntity=dDictionary.createEntity(\"Client\",\"Individual or Company to whom we may send invoices\");\r\n\t\t\t\t// NOTE: entity is created only client side => sync = false \r\n\t\t\t\t// NOTE:plural is calculated by dDictionary.plural(xSingular,\"En\");\r\n\t\t\t\t// returns true if succeded false if it fails\r\n\t\t\t\t//alert(\"dDictionary.createEntity xSingular=\"+xSingular);\r\n\t\t\t\t// FL.common.printToConsole(\"BEGIN ############################ FL.dd.createEntity ##############################\");\r\n\t\t\t\tvar oEntity=null;\r\n\t\t\t\tvar xPlural = null;\r\n\t\t\t\tvar xRet = false;\r\n\t\t\t\tif(!this.entities[xSingular]){//xSingular does not exist in dictionary\r\n\t\t\t\t\t// FL.common.printToConsole(\"FL.dd.createEntity ----------------->\"+xSingular+\" new!!!\");\r\n\t\t\t\t\tvar xNext = this.entities[\"__Last\"]+1;\r\n\t\t\t\t\tthis.entities[\"__Last\"] = xNext;\r\n\t\t\t\t\tvar xCSingular = getCompressed(xNext);\r\n\t\t\t\t\txPlural = plural(xSingular,\"En\");  //+\"s\";\r\n\t\t\t\t\toEntity = {singular:xSingular,csingular:xCSingular,plural:xPlural,description:xDescription,sync:false,lastId:0,L2C:{},C2L:{},attributes:[],relations:[]};\r\n\t\t\t\t\tthis.entities[xSingular] = oEntity;\r\n\t\t\t\t\tthis.addAttribute(xSingular,\"id\",xSingular+\"'s id\",\"#\",\"string\");//we need to set key=true !!!\r\n\t\t\t\t\tthis.entities[xSingular].attributes[0].key=true;\r\n\t\t\t\t\txRet = true;\r\n\t\t\t\t}else{//xSingular already exists in dictionary\r\n\t\t\t\t\t// alert(\"FL.dd.createEntity Error: you tried create entity \"+xSingular+\" but it already exists\");\r\n\t\t\t\t}\r\n\t\t\t\treturn xRet;\r\n\t\t\t},\r\n\t\t\tupdateEntityBySingular: function(xSingular,xOptions) {//updates an existing entity. It can uodate the entity key \"singular\"\r\n\t\t\t\t//Ex: updateEntityBySingular(\"client\",{singular:\"client\",plural:\"clients\",description:\"company that buys from us\"});\r\n\t\t\t\t//This method updates the server dictionary !!!! - it needs a working connection\r\n\t\t\t\tvar def = $.Deferred();\r\n\t\t\t\tvar oEntity=null;\r\n\t\t\t\tvar oEntityUpdate = null;\r\n\t\t\t\tvar xRet = false;\r\n\t\t\t\tif(this.entities[xSingular]){//xSingular exists in dictionary\r\n\t\t\t\t\tvar eCN = this.getCEntity(xSingular);\r\n\t\t\t\t\toEntity = this.entities[xSingular];\r\n\t\t\t\t\toEntityUpdate = _.extend(oEntity, xOptions);\r\n\t\t\t\t\tif(oEntityUpdate.singular!= xSingular){\r\n\t\t\t\t\t\tdelete this.entities[xSingular];//now that all relations are gone we can delete the entity\r\n\t\t\t\t\t\tthis.entities[oEntityUpdate.singular] = oEntityUpdate;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.entities[xSingular] = oEntityUpdate;\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar entityUpdatePromise = FL.API.updateDictionaryEntityProperties(eCN,oEntityUpdate);\r\n\t\t\t\t\tentityUpdatePromise.done(function(result){FL.common.printToConsole(\">>>>> updateEntityBySingular SUCCESS count=\"+result+\"<<<<<\");return def.resolve(result);});\r\n\t\t\t\t\tentityUpdatePromise.fail(function(err){FL.common.printToConsole(\">>>>> updateEntityBySingular FAILURE <<<<< \"+err);return def.reject(err);});\r\n\t\t\t\t\t//  oEntity.sync = false;\r\n\t\t\t\t\t// xRet = true;\r\n\t\t\t\t}else{//xSingular does not exists in dictionary\r\n\t\t\t\t\tvar err = \"FL.dd.updateEntityBySingular Error: you tried update \"+xSingular+\" but it does not exists in Dictionary\";\r\n\t\t\t\t\treturn def.reject(err);\r\n\t\t\t\t}\r\n\t\t\t\t// return xRet;\r\n\t\t\t\treturn def.promise();\r\n\t\t\t},\r\n\t\t\tupdateEntityByCName: function(xCName,xOptions) {//updates entity with compressed name = xCName with xOptions object\r\n\t\t\t\t//Ex: updateEntityByCName(\"02\",false,{plural:\"clients\",description:\"company that buys from us\"});\r\n\t\t\t\t//Note - that xCName may not exist because sync has changed to true- temporary compresede number was changed !\r\n\t\t\t\tvar xRet = false;\r\n\t\t\t\tvar oEntityUpdate = null;\r\n\t\t\t\tvar oldSingular = null;\r\n\t\t\t\tvar arrOfRightSide = _.values(this.entities);//an array of JSONs\r\n\t\t\t\tvar oEntity = _.find(arrOfRightSide, function(element) {return element.csingular == xCName;});\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\toldSingular = oEntity.singular;\r\n\t\t\t\t\toEntityUpdate = _.extend(oEntity, xOptions);\r\n\t\t\t\t\tdelete this.entities[oldSingular];\r\n\t\t\t\t\tvar newSingular =  oEntityUpdate.singular;\r\n\t\t\t\t\tthis.entities[newSingular] = oEntityUpdate;\r\n\t\t\t\t\tthis.entities[newSingular].sync = false;\r\n\t\t\t\t\txRet = true;\r\n\t\t\t\t}else{//xCName does not exists in dictionary\r\n\t\t\t\t\talert(\"FL.dd.updateEntityByCName Error: you tried to update an entity with compressedName=\"+xCName+\" but it does not exists in local Dictionary\");\r\n\t\t\t\t}\r\n\t\t\t\treturn xRet;\r\n\t\t\t},\r\n\t\t\tgetCEntity: function(xEntity) {//returns the compressed name of a logical name xEntity - if does not exist =>returns null\r\n\t\t\t\t//returns the compressed name of the logical name xEntity. The method is a NOP if xEntity is null;\r\n\t\t\t\tvar xCEntity=null;\r\n\t\t\t\tif(xEntity){\r\n\t\t\t\t\tvar oEntities = this.entities;\r\n\t\t\t\t\tif(oEntities[xEntity])\r\n\t\t\t\t\t\txCEntity=oEntities[xEntity].csingular;\r\n\t\t\t\t}\r\n\t\t\t\treturn xCEntity;\r\n\t\t\t},\r\n\t\t\tgetEntityByCName: function(eCN) {//returns the  logical name for compressed name = eCN. If not found returns null\r\n\t\t\t\t//finds the first all keys of this.entities will be searched looking for key.csingular = eCN \r\n\t\t\t\tvar entityName = null;\r\n\t\t\t\tvar valuesArr = _.values(this.entities);\r\n\t\t\t\t//note for _.find: if valuesArr is and array of objects =>element is the value of each key/value and returns value\r\n\t\t\t\tvar oEntity = _.find(valuesArr, function(element){//element is each array element. If is an object it returns the value\r\n\t\t\t\t\tif(typeof element == \"number\")\r\n\t\t\t\t\t\treturn false;//necessary to skip __Last:<number> and __LastRelation:<number>\r\n\t\t\t\t\treturn element.csingular == eCN;\r\n\t\t\t\t});\r\n\t\t\t\tif (oEntity) \r\n\t\t\t\t\tentityName = oEntity.singular;\r\n\t\t\t\treturn entityName;\r\n\t\t\t},\r\n\t\t\taddAttribute: function(xSingular,xAttribute,xDescription,xLabel,xType,xTypeUI,arrEnumerable) {//adds AttributeName,Description, label Type and enumerable to entity = xSingular\t\t\t\r\n\t\t\t// addAttribute: function(xSingular,xAttribute,xDescription,xLabel,xType,arrEnumerable) {//adds AttributeName,Description, label Type and enumerable to entity = xSingular\r\n\t\t\t\t// xSingular - Entity name (singular) to add attribute\r\n\t\t\t\t// xAttribute - attribute name (Nico's \"3\")\r\n\t\t\t\t// xDescription - attribute description (Nico's \"4\")\r\n\t\t\t\t// xLabel - attribute label (Nico's \"K\")\r\n\t\t\t\t// xType - attribute data type (Nico's \"M\") - possible datatypes:string, integer, number, boolean, date, or json \r\n\t\t\t\t// xTypeUI - widget to use for UI (Nico's \"9\") - possible values: textbox, integerbox, numberbox, percentbox, currencybox,\r\n\t\t\t\t//\t\t areabox, emailbox, phonebox, datetimebox, combobox, checkbox, urlbox, lookupbox -->TBI imagebox, geoBox\r\n\t\t\t\t// xMask - not a paramenter but inserted in dict as null - format mask applicable to textbox, integerbox, numberbox, percentbox and currencybox\r\n\t\t\t\t// xSpecialTypeDef - not a paramenter but inserted in dict as null - Special type definition . ex of specialtype is typeUI==\"lookup\" \r\n\t\t\t\t// arrEnumerable -  an array of enumerables or null  (Nico's \"N\")\r\n\t\t\t\t// key - optional default = false - it is only true for standard attribute \"id\"\r\n\t\t\t\t\r\n\t\t\t\t// if Type != \"enumerable\" => ArrEnumerable will be forced to null.\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\t// if xAttribute already exists it is updated with xDescription, xLabel, xType, xTypeUI, arrEnumerable (xKey will not be changed)\r\n\t\t\t\t// if xAttribute does not exist it is created with xDescription, xType and xKey forced to false\r\n\t\t\t\t// if xTypeUI is different from \"combobox\" arrEnumerable is forced to false\r\n\t\t\t\t//\t\t\r\n\t\t\t\t// NOTE on xKey - the only attribute that has xKey=true is always created or removed when the entity is created or removed\r\n\t\t\t\t//    To update the name and description of the key attribute of a just created attribute:\r\n\t\t\t\t//\t\tdDictionary.createEntity(\"Client\",\"clients\",\"Individual or Company to whom we may send invoices\");//singular, plural, description\r\n\t\t\t\t//\t\tdDictionary.renameAttribute(\"Client\",\"id\",\"name\");//renaming the key attribute\r\n\t\t\t\t//\t\tdDictionary.addAttribute(\"Client\",\"name\",\"client's id\",\"Name\",\"string\",\"textbox\",null);\r\n\t\t\t\t//\t\t\r\n\t\t\t\t//\t\tIf we are updating a key attribute we force the type to \"number\" independently of the xType parameter\r\n\t\t\t\t//\t\r\n\t\t\t\t// NOTE: type is mandatory and must be one of: string, integer, number, Boolean, date, or json (this will be Nico's \"M\") \r\n\t\t\t\t//oEntity={singular:\"Client\",plural:\"clients\",description:\"Company to send invoices\",lastId:0,L2C:{},C2L:{},attributes:[]};\r\n\t\t\t\t//checks if attribute already exists. If it exists updates, otherwise create it !!!\r\n\t\t\t\t//console.clear();\r\n\t\t\t\tvar xMask = null;\r\n\t\t\t\tvar xSpecialTypeDef = null;\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar xIndex = attributeIndex(xSingular,xAttribute);\r\n\t\t\t\t\tif(xIndex<0){//if it does not exists creates it\r\n\t\t\t\t\t\tvar nId = oEntity.lastId++;\r\n\t\t\t\t\t\tvar sComp = getCompressed(nId++);\r\n\t\t\t\t\t\t//({name:\"address\",description:\"address to send invoices\",label:\"Address\",type:\"string\",enumerable:null,key:false});\r\n\t\t\t\t\t\tif( (xType != \"string\") && (xTypeUI != \"combobox\"))\r\n\t\t\t\t\t\t\tarrEnumerable = null;\r\n\t\t\t\t\t\toEntity.attributes.push({name:xAttribute, description:xDescription, label:xLabel, type:xType, typeUI:xTypeUI, mask:xMask, specialTypeDef:xSpecialTypeDef, enumerable:arrEnumerable, key:false});\r\n\t\t\t\t\t\toEntity.L2C[xAttribute] = sComp;//Logical to Compressed\r\n\t\t\t\t\t\toEntity.C2L[sComp] = xAttribute;//Compressed to Logical\r\n\t\t\t\t\t\t// oEntity.lastId = nId;\r\n\t\t\t\t\t}else{//updates the existing attribute - if xKey is true (it will continue to be true)\r\n\t\t\t\t\t\toEntity.attributes[xIndex].description = xDescription;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].label = xLabel;\r\n\t\t\t\t\t\tif(oEntity.attributes[xIndex].key)//if we are updating a key attribute we force the type to \"number\"\r\n\t\t\t\t\t\t\txType=\"number\";\r\n\t\t\t\t\t\toEntity.attributes[xIndex].type = xType;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].typeUI = xTypeUI;\r\n\t\t\t\t\t\tif( (xType != \"string\") && (xTypeUI != \"combobox\"))\r\n\t\t\t\t\t\t\tarrEnumerable = null;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].enumerable = arrEnumerable;\r\n\r\n\t\t\t\t\t\t//oEntity.attributes[xIndex].key=xKey;\r\n\t\t\t\t\t}\r\n\t\t\t\t\toEntity.sync = false;\r\n\t\t\t\t\t//dDictionary.save(xSingular,oEntity);\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.addAttribute Error: you tried to add attribute \"+xAttribute+\" to a non existing entity \"+xSingular);\r\n\t\t\t\t\t//Err.alert(\"dDictionary.addAttribute\",(new Error),\" you tried to add attribute \"+xAttribute+\" to a non existing entity \"+xSingular);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupsertAttribute: function(xSingular,xAttribute,options){// upserts attribute in table with logical name = sSingular\r\n\t\t\t\t// xSingular - Entity name (singular) to add attribute\r\n\t\t\t\t// xAttribute - attribute name (Nico's \"3\")\r\n\t\t\t\t// options is an object {} with properties:\r\n\t\t\t\t// \t\tdescription - attribute description (Nico's \"4\")\r\n\t\t\t\t// \t\tlabel - attribute label (Nico's \"K\")\r\n\t\t\t\t// \t\ttype - attribute data type (Nico's \"M\") - possible datatypes:string, json or geoLocalization\r\n\t\t\t\t// \t\ttypeUI - widget to use for UI (Nico's \"9\") - possible values: textbox, integerbox, numberbox, percentbox, currencybox,\r\n\t\t\t\t//\t\t    areabox, emailbox, phonebox, datetimebox, combobox, checkbox, urlbox, lookupbox -->TBI imagebox, geoBox\r\n\t\t\t\t// \t\tmask - format mask applicable to textbox, integerbox, numberbox, percentbox and currencybox\r\n\t\t\t\t// \t\tspecialTypeDef - Special type definition. If typeUI==\"lookup\" =>specialTypeDef=\"<eCN>\" entity compressed name of lookup entity\r\n\t\t\t\t// \t\tenumerable - arrEnumerable -  an array of enumerables or null  (Nico's \"N\")\r\n\t\t\t\t// \t\tkey - optional default = false - it is only true for standard attribute \"id\"\r\n\t\t\t\t//\r\n\t\t\t\t// if Type != \"enumerable\" => ArrEnumerable will be forced to null.\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\t// if xAttribute already exists it is updated with xDescription, xLabel, xType, xTypeUI, arrEnumerable (xKey will not be changed)\r\n\t\t\t\t// if xAttribute does not exist it is created with xDescription, xType and xKey forced to false\r\n\t\t\t\t// if xTypeUI is different from \"combobox\" arrEnumerable is forced to false\r\n\t\t\t\t//\t\t\r\n\t\t\t\t// NOTE on xKey - the only attribute that has xKey=true is always created or removed when the entity is created or removed\r\n\t\t\t\t//    To update the name and description of the key attribute of a just created attribute:\r\n\t\t\t\t//\t\tdDictionary.createEntity(\"Client\",\"clients\",\"Individual or Company to whom we may send invoices\");//singular, plural, description\r\n\t\t\t\t//\t\tdDictionary.renameAttribute(\"Client\",\"id\",\"name\");//renaming the key attribute\r\n\t\t\t\t//\t\tdDictionary.addAttribute(\"Client\",\"name\",\"client's id\",\"Name\",\"string\",\"textbox\",null);\r\n\t\t\t\t//\t\t\r\n\t\t\t\t//\t\tIf we are updating a key attribute we force the type to \"number\" independently of the xType parameter\r\n\t\t\t\t//\t\r\n\t\t\t\t// NOTE: type is mandatory and must be one of: string, integer, number, Boolean, date, or json (this will be Nico's \"M\") \r\n\t\t\t\t//oEntity={singular:\"Client\",plural:\"clients\",description:\"Company to send invoices\",lastId:0,L2C:{},C2L:{},attributes:[]};\r\n\t\t\t\t//checks if attribute already exists. If it exists updates, otherwise create it !!!\r\n\t\t\t\t//console.clear();\r\n\t\t\t\tvar propsToUse = {name:xAttribute, description:null, label:\"\", type:\"string\", typeUI:\"textbox\", mask:null, specialTypeDef:null, enumerable:null, key:false};\r\n\t\t\t\t_.extend(propsToUse,options);\r\n\t\t\t\t// enforcements -------\r\n\t\t\t\tif(propsToUse.type != \"string\"  && propsToUse.typeUI != \"combobox\")\r\n\t\t\t\t\tpropsToUse.enumerable == null;\r\n\t\t\t\tif(propsToUse.typeUI != \"textbox\"  && propsToUse.typeUI != \"integerbox\" && propsToUse.typeUI != \"numberbox\" && propsToUse.typeUI != \"percentbox\"  && propsToUse.typeUI != \"currencybox\" )\r\n\t\t\t\t\tpropsToUse.mask == null;\r\n\t\t\t\tif(propsToUse.typeUI != \"lookupbox\" )\r\n\t\t\t\t\tpropsToUse.specialTypeDef == null;\r\n\t\t\t\t// -------------------\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar xIndex = attributeIndex(xSingular,xAttribute);\r\n\t\t\t\t\tif(xIndex<0){//if it does not exists creates it\r\n\t\t\t\t\t\tvar nId = oEntity.lastId++;\r\n\t\t\t\t\t\tvar sComp = getCompressed(nId++);//we must go to Nico's server !!!!!!!!!!!!!\r\n\t\t\t\t\t\toEntity.attributes.push(propsToUse);\r\n\t\t\t\t\t\toEntity.L2C[xAttribute] = sComp;//Logical to Compressed\r\n\t\t\t\t\t\toEntity.C2L[sComp] = xAttribute;//Compressed to Logical\r\n\t\t\t\t\t\t// oEntity.lastId = nId;\r\n\t\t\t\t\t}else{//updates the existing attribute - if xKey is true (it will continue to be true)\r\n\t\t\t\t\t\toEntity.attributes[xIndex].description = propsToUse.description;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].label = propsToUse.label;\r\n\t\t\t\t\t\tif(oEntity.attributes[xIndex].key)//if we are updating a key attribute we force the type to \"number\"\r\n\t\t\t\t\t\t\tpropsToUse.type=\"number\";\r\n\t\t\t\t\t\toEntity.attributes[xIndex].type = propsToUse.type;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].typeUI = propsToUse.typeUI;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].mask = propsToUse.mask;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].specialTypeDef = propsToUse.specialTypeDef;\r\n\t\t\t\t\t\toEntity.attributes[xIndex].enumerable = arrEnumerable;\r\n\t\t\t\t\t\t//oEntity.attributes[xIndex].key=xKey;\r\n\t\t\t\t\t}\r\n\t\t\t\t\toEntity.sync = false;\r\n\t\t\t\t\t//dDictionary.save(xSingular,oEntity);\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.upsertAttribute Error: you tried to add attribute \"+xAttribute+\" to a non existing entity \"+xSingular);\r\n\t\t\t\t}\r\n\t\t\t},\t\r\n\t\t\tgetEntityAttribute: function(xSingular,xAttribute) {\r\n\t\t\t\t// for entity xSingular and attribute with name=xAttribute returns:\r\n\t\t\t\t//\t  {name:xName,description:xDescription,label:xLabel,type:xType,typeUI:xTypeUI,mask:xMask, specialTypeDef:xSpecialTypeDef, enumerable:xEnumerable}\r\n\t\t\t\t//returns null if entity or attribute does not exist\r\n\t\t\t\tvar oAttributes = null;\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar xIndex = attributeIndex(xSingular,xAttribute);\r\n\t\t\t\t\tif(xIndex>=0){//if attribute exists\r\n\t\t\t\t\t\toAttributes = oEntity.attributes[xIndex];\r\n\t\t\t\t\t}\t\r\n\t\t\t\t}\t\r\n\t\t\t\treturn oAttributes;\r\n\t\t\t},\r\n\t\t\tupdateAttribute: function(xSingular,xAttribute,changeObj){\r\n\t\t\t\t//changeObj is an object with keys corresponding to xAttribute (old name - notice that the name itself can be changed).\r\n\t\t\t\t// May have any key or key combination of:{name:xName,description:xDescription,label:xLabel,type:xType,typeUI:xTypeUI,enumerable:xEnumerable}\r\n\t\t\t\tvar def = $.Deferred();\r\n\t\t\t\tvar err = null;\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar xIndex = attributeIndex(xSingular,xAttribute);\r\n\t\t\t\t\tif(xIndex>=0){//if attribute exists\r\n\t\t\t\t\t\tvar attributesCopy = getDictAttributesBackup(oEntity.attributes);//it is an overkill- we only need one attribute\r\n\t\t\t\t\t\tvar attrCopy = attributesCopy[xIndex];\r\n\t\t\t\t\t\t// var oAttributes = _.extend(oEntity.attributes[xIndex], changeObj);//notice that the attribute name may also belong to changeObj\r\n\t\t\t\t\t\tvar oAttributes = _.extend(attrCopy, changeObj);//notice that the attribute name may also belong to changeObj\r\n\t\t\t\t\t\tif(oAttributes.name != xAttribute ){//attribute name was changed. It is necessary to update L2C and C2L\r\n\t\t\t\t\t\t\tvar compressedAttr = oEntity.L2C[xAttribute];\r\n\t\t\t\t\t\t\toEntity.C2L[compressedAttr] = oAttributes.name;//Compressed to Logical is updated\r\n\t\t\t\t\t\t\tdelete oEntity.L2C[xAttribute];\r\n\t\t\t\t\t\t\toEntity.L2C[oAttributes.name] = compressedAttr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toEntity.attributes[xIndex] = _.omit(oAttributes,\"oldname\",\"singular\");\r\n\t\t\t\t\t\tvar fCN = oEntity.L2C[oAttributes.name];\r\n\t\t\t\t\t\t//send to server\r\n\t\t\t\t\t\tvar promise = FL.API.updateDictionaryAttribute(fCN,oAttributes);\r\n\t\t\t\t\t\tpromise.done(function(result){\r\n\t\t\t\t\t\t\toEntity.sync = true;\r\n\t\t\t\t\t\t\treturn def.resolve(result);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tpromise.fail(function(err){\r\n\t\t\t\t\t\t\toEntity.sync = false;\r\n\t\t\t\t\t\t\treturn def.reject(err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\terr = \"FL.dd.updateAttribute Error: impossible to update attribute \"+xAttribute+\". It does not exist in entity \"+xSingular;\r\n\t\t\t\t\t\treturn def.reject(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\terr = \"FL.dd.updateAttribute Error: you tried to update attribute \"+xAttribute+\" to a non existing entity \"+xSingular;\r\n\t\t\t\t\treturn def.reject(err);\r\n\t\t\t\t}\r\n\t\t\t\treturn def.promise();\r\n\t\t\t},\r\n\t\t\taddRelation: function(xSingular,withEntityName,verb,cardinality,side,storedHere,xLanguage) {//adds a new relation to the array of relations of entity xSingular\r\n\t\t\t\t//xLanguage --> En, Fr, Nl, Pt\r\n\t\t\t\t//NOTE: the rCN relation compressed name is retirned by the server when we try to create the relation.\r\n\t\t\t\t//      In order to follow the approach -->\"first we create in local dictionary the we synchronize to the server\" we begin by generating\r\n\t\t\t\t//\t\tan unique compressed name in the client that will be updated when we save the relation in the server. The unique relation compressed\r\n\t\t\t\t//\t\tname is generated from entities.__LastRelation \r\n\t\t\t\t//ex:FL.dd.addRelation(entities[i].d[\"3\"],rCN,withEntityName,verb,cardinality,side,storedHere);\r\n\t\t\t\t//\t{idRelation:3,cIdRelation:\"03\",rightEntity:\"Invoice\",description:\"has\",cardinality:\"0_1\",semantic:\"Client has many Invoices\",delChildren:false}\r\n\t\t\t\t//dDictionary.addRelation= function(xSingular,sRightEntity,sDescription,sCardinality,bDelChildren,xLanguage) {//adds/updates a relation to the Data Dictionary\r\n\r\n\r\n\t\t\t\t//     In real live we could have: \r\n\t\t\t\t//\t\t\t\t\t\"invoice\" \"has\" \"one and only one\" \"client\" - a first relation between invoice and client\r\n\t\t\t\t//\t\t\t\t\t\"invoice\" \"products must be delivered to\" \"one and only one\" \"client\" - a second relation between invoice and client\r\n\t\t\t\t// alert(\"step1\");\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tvar oToEntity = this.entities[withEntityName];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tif(oToEntity){\r\n\t\t\t\t\t\t// checks if rCN already exists - if it exists it does not add\r\n\t\t\t\t\t\tif (FL.dd.isRelation(xSingular,rCN)){\r\n\t\t\t\t\t\t\talert(\"FL.dd.addRelation Error: you tried to add a relation with a compressed name \"+rCN+\" that already exists !\");\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t// var xNextRelation=dDictionary.entities[\"__LastRelation\"]+1; ???????????\r\n\t\t\t\t\t\t\t// dDictionary.entities[\"__LastRelation\"]=xNextRelation; ???????????????\r\n\t\t\t\t\t\t\tvar xNext = this.entities[\"__LastRelation\"]+1;\r\n\t\t\t\t\t\t\tthis.entities[\"__LastRelation\"] = xNext;\r\n\t\t\t\t\t\t\tvar rCN = getCompressed(xNext);\r\n\r\n\t\t\t\t\t\t\tvar side2 = 1;//we assume (0 - 1) if not we set  (1 - 0)\r\n\t\t\t\t\t\t\tif(side == 1)//Side, either 0 or 1. Mandatory\r\n\t\t\t\t\t\t\t\tside2 = 0;\r\n\t\t\t\t\t\t\tvar storedHere2 = false;//we assume (true - false) if not we set (false - true)\r\n\t\t\t\t\t\t\tif(!storedHere)//storedHere. Where to store the relation. Should be true to at least one side. \r\n\t\t\t\t\t\t\t\tstoreHere2 = true;\r\n\r\n\t\t\t\t\t\t\tvar relation = prepareRelation(xSingular,rCN,withEntityName,verb,cardinality,side,storedHere,xLanguage);\r\n\t\t\t\t\t\t\toEntity.relations.push(relation);\r\n\r\n\t\t\t\t\t\t\tvar verb2 = invertedToOneVerb(verb,xLanguage);\r\n\t\t\t\t\t\t\tvar cardinality2 = \"1\";//Cardinality. Not used by the datalayer. Could be 1 or N. Mandatory\r\n\t\t\t\t\t\t\tif(cardinality == \"1\")\r\n\t\t\t\t\t\t\t\tcardinality2 = \"N\";\r\n\r\n\t\t\t\t\t\t\tvar relation2 = prepareRelation(withEntityName,rCN,xSingular,verb2,cardinality2,side2,storedHere2,xLanguage);\r\n\t\t\t\t\t\t\toToEntity.relations.push(relation2);\r\n\t\t\t\t\t\t\toToEntity.sync = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\talert(\"FL.dd.addRelation Error: you tried to add a relation between \"+xSingular+\" and a non existing entity \"+withEntityName);\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.addRelation Error: you tried to add a relation \"+relationName+\" to a non existing entity \"+xSingular);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trelationPass2: function() {//goes thru all entities and for all relations of each entity fills withEntity and semantic using withEntityCN. Finally it sets sync = true for entity\r\n\t\t\t\tvar valuesArr = _.values(this.entities);\r\n\t\t\t\t//note for _.find: if valuesArr is and array of objects =>element is the value of each key/value and returns value\r\n\t\t\t\t_.each(valuesArr, function(element){//element is each array element. If is an object it returns the value\r\n\t\t\t\t\tif(typeof element != \"number\"){\r\n\t\t\t\t\t\t// FL.common.printToConsole(\"Pass2 -->\"+element.singular);\r\n\t\t\t\t\t\tvar xSingular = element.singular;\r\n\t\t\t\t\t\t_.each(element.relations, function(relation){//relation is a relation from the current entity\r\n\t\t\t\t\t\t\trelation[\"withEntity\"] = FL.dd.getEntityByCName(relation[\"withEntityCN\"]);\r\n\t\t\t\t\t\t\trelation[\"semantic\"] = FL.dd.relationSemantics(xSingular,relation[\"withEntity\"],relation[\"verb\"],relation[\"cardinality\"],\"En\");//sSingular,sRightEntity,sVerb,sCardinality,xLanguage\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tFL.dd.setSync(xSingular,true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tisRelation: function(xSingular,rCN) {//returns true if relation exists, false otherwise \r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar arrPos = _.find(oEntity.relations, function(element){return element.rCN == rCN;});\r\n\t\t\t\t\tif (arrPos>=0)\r\n\t\t\t\t\t\texists = true;\r\n\t\t\t\t}\r\n\t\t\t\treturn exists;\r\n\t\t\t},\r\n\t\t\tgetEntityBySingular: function(xSingular) {//returns an entity and its attributes\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\treturn oEntity;\r\n\t\t\t},\r\n\t\t\tisEntityInLocalDictionary: function(entityName) {//returns true if entityName exists in local dictionary\r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tif(this.getEntityBySingular(entityName))//if getEntityBySingular is not null =>exists = true\r\n\t\t\t\t\texists = true;\r\n\t\t\t\treturn exists;\r\n\t\t\t},\r\n\t\t\tisEntityInLocalDictionaryByCN: function(eCN) {//returns true if compressed entity name (eCN) exists in local dictionary\r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tif(this.getEntityByCName(eCN))\r\n\t\t\t\t\texists = true;\r\n\t\t\t\treturn exists;\r\n\t\t\t},\r\n\t\t\thistoMailPeer: function(entityName){\r\n\t\t\t\tvar eCN = this.getCEntity(entityName);\r\n\t\t\t\treturn histoName = \"_histoMail_\" + eCN;\r\n\t\t\t},\r\n\t\t\tpeerTypeFor: function(typeOfPeer,entityName){//for type histoMail and entity ecn=55 forms \"_histomail_55\"\r\n\t\t\t\tvar eCN = this.getCEntity(entityName);\r\n\t\t\t\treturn histoName = \"_\" + typeOfPeer + \"_\" + eCN;\r\n\t\t\t},\r\n\t\t\tisHistoMailPeer: function(entityName) {//returns true if _histoMail_<ecn(entityName)> exists in local dictionary\r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tif(this.isEntityInLocalDictionary( this.histoMailPeer( entityName ) ) ){\r\n\t\t\t\t\texists = true;\r\n\t\t\t\t}\r\n\t\t\t\treturn exists;\r\n\t\t\t},\r\n\t\t\tisHistoMailPeerByCN: function(ecN) {//returns true if _histoMail_<ecn> exists in local dictionary\r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tif(this.isEntityInLocalDictionary( \"_histoMail_\"+eCN ) ){\r\n\t\t\t\t\texists = true;\r\n\t\t\t\t}\r\n\t\t\t\treturn exists;\r\n\t\t\t},\t\t\t\r\n\t\t\tisEntityWithTypeUI: function(entityName,typeUI) {//returns true if entityName has an Email field \r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tvar oEntity = this.entities[entityName];\r\n\t\t\t\tif(oEntity){//searches for the first Email field\r\n\t\t\t\t\tvar el = _.find(oEntity.attributes, function(element){\r\n\t\t\t\t\t\treturn element.typeUI == typeUI;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(el){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.isEntityWithTypeUI Error: \"+entityName+\" does not exist ! \");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfirstEmailAttribute: function(eCN){\r\n\t\t\t\tvar emailAttr = null;\r\n\t\t\t\tvar entityName = this.getEntityByCName(eCN);\r\n\t\t\t\tvar oEntity = this.entities[entityName];\r\n\t\t\t\tvar el = _.find(oEntity.attributes, function(element){\r\n\t\t\t\t\treturn ( element.typeUI == \"emailbox\" || element.typeUI == \"email\");\r\n\t\t\t\t\t// if ( element.typeUI == \"emailbox\" || element.typeUI == \"email\")\r\n\t\t\t\t\t// \treturn element.name;\r\n\t\t\t\t});\r\n\t\t\t\tif( !_.isUndefined(el) )\r\n\t\t\t\t\temailAttr = el.name;\r\n\t\t\t\treturn emailAttr;\r\n\t\t\t},\r\n\t\t\tisEntityInSync: function(entityName) {//returns true if entityName has in sync status = true\r\n\t\t\t\tvar exists = false;\r\n\t\t\t\tvar oEntity = this.entities[entityName];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\treturn oEntity.sync;\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.isEntityInSync Error: \"+entityName+\" does not exist ! \");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisEntityByCNInSync: function(eCN) {//returns true if eCN has in sync status = true - if eCN does not exist returns false\r\n\t\t\t\tvar entityName = this.getEntityByCName(eCN);\r\n\t\t\t\tif(entityName){\r\n\t\t\t\t\tvar oEntity = this.entities[entityName];\r\n\t\t\t\t\tif(oEntity){\r\n\t\t\t\t\t\treturn oEntity.sync;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\talert(\"FL.dd.isEntityByCNInSync Error: Entity compressed name =\" + eCN + \" exists, but associated entityName=\" + entityName + \" does not exist ! \");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tsetSync: function(xSingular,bStatus) {//set sync = true for entity= xSingular - nothing is done if entity does not exist\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\toEntity.sync = bStatus;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsetFieldTypeUI: function(xSingular,fieldName,newTypeUI) {//sets typeUI = newTypeUI for field = fieldName in entity xSingular\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\toEntity.sync = false;\r\n\t\t\t\t\tvar el = _.find(oEntity.attributes, function(element){\r\n\t\t\t\t\t\treturn element.name == fieldName;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(el){\r\n\t\t\t\t\t\tel.typeUI = newTypeUI;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\talert(\"FL.dd.setFieldTypeUI Error: field \" + fieldName + \" does not exist in entity \" + xSingular );\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.setFieldTypeUI Error: \"+xSingular+\" does not exist ! \");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreateHistoMailPeer: function(entityName){//create histoMail peer in local dict\r\n\t\t\t\tvar fName = this.histoMailPeer(entityName);\r\n\t\t\t\tif(!this.isEntityInLocalDictionary(fName)){\r\n\t\t\t\t\tthis.createEntity(fName,\"histoMail peer for \" + entityName);\r\n\t\t\t\t\t//\t\t{name:\"address\",description:\"address to send invoices\",label:\"Address\",type:\"string\",typeUI:\"textbox\",enumerable:null,key:false});\r\n\t\t\t\t\tthis.addAttribute(fName,\"msg\",fName + \"'s msg\",\"XXX\",\"string\",\"textbox\",null);\r\n\t\t\t\t\tthis.setSync(fName,false);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.createHistoMailPeer Error: \" + fName + \", the histomail peer for \"+entityName+\" exists already! \");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tremoveHistoMailPeer: function(entityName){//remove histoMail peer in local dict\r\n\t\t\t\tvar fName = this.histoMailPeer(entityName);\r\n\t\t\t\tif(this.isEntityInLocalDictionary(fName)){\r\n\t\t\t\t\tthis.removeEntity(fName);\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.removeHistoMailPeer Error: \" + fName + \", the histomail peer for \"+entityName+\" does not exist! \");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\t\t\t\t\r\n\t\t\tsetFieldCompressedName: function(xSingular,fieldName,fieldCN) {//for entity xSingular and attribute fieldName sets compressed name\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\toEntity.sync = false;\r\n\t\t\t\t\tvar oldCFieldName = oEntity.L2C[fieldName];\r\n\t\t\t\t\tif(oldCFieldName){\r\n\t\t\t\t\t\tdelete oEntity.C2L[oldCFieldName];\r\n\t\t\t\t\t\toEntity.L2C[fieldName] = fieldCN;//Logical to Compressed\r\n\t\t\t\t\t\toEntity.C2L[fieldCN] = fieldName;//Compressed to Logical\t\t\t\t\t\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetFieldCompressedName: function(xSingular,fieldName) {//for entity xSingular and attribute fieldName gets compressed name\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tvar fieldCN = null;\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tfieldCN = oEntity.L2C[fieldName];\r\n\t\t\t\t}\r\n\t\t\t\treturn fieldCN;\r\n\t\t\t},\r\n\t\t\tgetArrayOfFields: function(xSingular) {//for entity xSingular return an array of JSON including statment\r\n\t\t\t\t// The array has an object for each field with {attribute:xName, description:xDescription,statement:xStatement}\r\n\t\t\t\t// Ex: returning items (excepting id)\r\n\t\t\t\t//  items = [\r\n\t\t\t\t//         {attribute:\"name\", description:\"official designation\",statement:\"the name of the client is the official designation\"},\r\n\t\t\t\t//         {attribute:\"address\", description:\"place to send invoices\",statement:\"The address of the client is the place to send invoices\"},\r\n\t\t\t\t//         {attribute:\"city\", description:\"headquarters place\", statement:\"The city of the client is the headquarters place\"},\r\n\t\t\t\t//         {attribute:\"postal code\", description:\"postal reference for delivery\",statement:\"The postal code of the client is the postal reference for delivery\"}\r\n\t\t\t\t//\t\t];\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tvar xRetArr = [];\r\n\t\t\t\tvar fieldCN = null;\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\t_.each(oEntity.attributes, function(element, index){\r\n\t\t\t\t\t\tif(element.name != \"id\"){\r\n\t\t\t\t\t\t\tvar el = {};\r\n\t\t\t\t\t\t\tel[\"attribute\"] = element.name;\r\n\t\t\t\t\t\t\tel[\"description\"] = element.description;\r\n\t\t\t\t\t\t\tel[\"statement\"] = attributeSemantics(element.name,element.description,oEntity,\"En\");\r\n\t\t\t\t\t\t\t//--- added at 12/2/2015\r\n\t\t\t\t\t\t\tel[\"type\"] = element.type;\r\n\t\t\t\t\t\t\tel[\"enumerable\"] = element.enumerable;\r\n\t\t\t\t\t\t\tel[\"typeUI\"] = element.typeUI;\r\n\t\t\t\t\t\t\tel[\"mask\"] = element.mask;\r\n\t\t\t\t\t\t\tel[\"specialTypeDef\"] = element.specialTypeDef;\r\n\t\t\t\t\t\t\t// ----\r\n\t\t\t\t\t\t\txRetArr.push(el);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.getArrayOfFields Error: entity \"+xSingular+\" does not exit in FrameLink dictionary.\");\r\n\t\t\t\t}\r\n\t\t\t\treturn xRetArr;\r\n\t\t\t},\r\n\t\t\tsetEntityFieldsBySingular: function(xSingular,fieldsArr,changedAttributesArr) {//sets all fields of entity xSingular.If xSingular does not exist nothing is done.\r\n\t\t\t\t// fieldsArr - an Array of objects, each one with the format:\r\n\t\t\t\t//     {name:\"address\",description:\"address to send invoices\",label:\"Address\",type:\"string\",typeUI:\"textbox\",enumerable:eNumArr,key:false});\r\n\t\t\t\t//changedAttributesArr - an array of arrays. Each array element is an array with 2 elements [oldName,newName]\r\n\t\t\t\tif( !_.isUndefined(this.entities[xSingular]) ){\r\n\t\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\t\t_.each(changedAttributesArr, function(element){\r\n\t\t\t\t\t\tvar oldName = element[0];\r\n\t\t\t\t\t\tvar newName = element[1];\r\n\t\t\t\t\t\tvar compressedAttr = oEntity.L2C[oldName];\r\n\t\t\t\t\t\toEntity.C2L[compressedAttr] = newName;\r\n\t\t\t\t\t\tdelete oEntity.L2C[oldName];\r\n\t\t\t\t\t\toEntity.L2C[newName] = compressedAttr;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.entities[xSingular].attributes = fieldsArr;\r\n\t\t\t\t}\t\r\n\t\t\t},\r\n\t\t\tuserTypes: {///the opposite of userType() -->for a single userType returns type and typeUI. Ex FL.dd.userTypes.email =>{type:\"string\",typeUI:\"emailbox\"}\r\n\t\t\t\t\"text\"  :{type:\"string\",typeUI:\"textbox\"},\r\n\t\t\t\t\"integer\":{type:\"string\",typeUI:\"integerbox\"},\r\n\t\t\t\t\"number\":{type:\"string\",typeUI:\"numberbox\"},\r\n\t\t\t\t\"percent\":{type:\"string\",typeUI:\"percentbox\"},\r\n\t\t\t\t\"currency\":{type:\"string\",typeUI:\"currencybox\"},\r\n\t\t\t\t\"text upper\"  :{type:\"string\",typeUI:\"textUpperbox\"},//\"textbox\" is hard coded in FLgrid2.js --> dataRowAnalisys(rows,percent) for most basic type\r\n\t\t\t\t\"text area\":{type:\"string\",typeUI:\"areabox\"},\r\n\t\t\t\t\"email\" :{type:\"string\",typeUI:\"emailbox\"},\r\n\t\t\t\t\"phone\" :{type:\"string\",typeUI:\"phonebox\"},\r\n\t\t\t\t\"date\" :{type:\"string\",typeUI:\"datetimebox\"},//to prevent crash\r\n\t\t\t\t\"datetime\" :{type:\"string\",typeUI:\"datetimebox\"},\r\n\t\t\t\t\"combo list\":{type:\"string\",typeUI:\"combobox\"},\r\n\t\t\t\t\"check\":{type:\"string\",typeUI:\"checkbox\"},\r\n\t\t\t\t\"url\":{type:\"string\",typeUI:\"urlbox\"},\r\n\t\t\t\t\"lookup\":{type:\"string\",typeUI:\"lookupbox\"},\r\n\t\t\t},\r\n\t\t\tarrOfUserTypesForDropdown: function(){//returns an array of objects with keys value and text, mandatory for dropdowns.\r\n\t\t\t\t//\tvar arrOfObj=[{value:1,text:\"number\",something:\"abc\"},{value:2,text:\"text\",something:\"abc\"},{value:3,text:\"email\",something:\"abc\"},{value:4,text:\"phone\",something:\"abc\"},{value:5,text:\"enumerable\",something:\"abc\"},{value:6,text:\"date\",something:\"abc\"}];\r\n\t\t\t\tvar retArr = _.keys(this.userTypes);\r\n\t\t\t\tretArr = _.map(retArr, function(element,index){\r\n\t\t\t\t\treturn {\"value\":index+1,\"text\":element};\r\n\t\t\t\t});\r\n\t\t\t\treturn retArr;\r\n\t\t\t},\r\n\t\t\tuserType: function(attributesElement){//an element of attributesArr produced by csvStore.getAttributesArrNoId() or FL.dd.getArrayOfFields(entityName);//we retrieve all except name=\"id\r\n\t\t\t\t//given a pair type an typeUI of a local dictionary field, returns the corresponding userType - inversion of FL.dd.userType\r\n\t\t\t\t//this method is a centralization of userType attributes. For the user an email is diferent form a textbox or a phone.\r\n\t\t\t\t// for a pair type,typeUI returns a single userType\r\n\t\t\t\tvar userType = null;\r\n\t\t\t\tif(attributesElement.type == \"string\"){//type is one of: string, integer, number, boolean, date, or json (Nico's field \"M\")\r\n\t\t\t\t\tvar typeUIConverterInsideString = {\r\n\t\t\t\t\t\t\"textbox\":\"text\",\r\n\t\t\t\t\t\t\"integerbox\":\"integer\",\r\n\t\t\t\t\t\t\"numberbox\":\"number\",\r\n\t\t\t\t\t\t\"percentbox\":\"percent\",\r\n\t\t\t\t\t\t\"currencybox\":\"currency\",\r\n\t\t\t\t\t\t\"textUpperbox\":\"text upper\",\r\n\t\t\t\t\t\t\"areabox\":\"text area\",\r\n\t\t\t\t\t\t\"emailbox\":\"email\",\r\n\t\t\t\t\t\t\"email\":\"email\",\r\n\t\t\t\t\t\t\"phonebox\":\"phone\",\r\n\t\t\t\t\t\t\"datetimebox\":\"datetime\",\r\n\t\t\t\t\t\t\"combobox\":\"combo list\",\r\n\t\t\t\t\t\t\"checkbox\":\"check\",\r\n\t\t\t\t\t\t\"urlbox\":\"url\",\r\n\t\t\t\t\t\t\"lookupbox\":\"lookup\",\r\n\t\t\t\t\t};\r\n\t\t\t\t\tuserType = typeUIConverterInsideString[attributesElement.typeUI];\r\n\t\t\t\t}else{\r\n\t\t\t\t\tuserType = attributesElement.type;\r\n\t\t\t\t}\r\n\t\t\t\treturn userType;\r\n\t\t\t},\r\n\t\t\temptyRow: function(xSingular){//returns an object with keys for every attribute and empty values for each attribute\r\n\t\t\t\t//the name is emprtyRow because it was first used for grid new lines\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tvar newRow = null;\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar columnsArr = this.getArrayOfFields(xSingular);\r\n\t\t\t\t\t// columnsArr format: [{label:\"xx\",name:fieldName,type:xtype,enumerable:xEnumerable,typeUI:xTypeUI},{col2}...{}]\r\n\t\t\t\t\tnewRow = this.emptyRowForArrOfTypes(columnsArr);\r\n\t\t\t\t\tif(newRow.id)\r\n\t\t\t\t\t\tnewRow.id = oEntity.lastId+1;\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"FL.dd.emptyRow Error: \"+xSingular+\" does not exist ! \");\r\n\t\t\t\t}\r\n\t\t\t\treturn newRow;////returns {attribute1:emptyValue1,attribute2:emptyValue2...etc} or null\r\n\t\t\t},\r\n\t\t\temptyRowForArrOfTypes: function(columnsArr){//returns an object with keys for every attribute and empty values for each attribute\r\n\t\t\t\t//columns array is an array of objects where each object must have the keys name and type\r\n\t\t\t\t//      example: [{label:\"xx\",name:fieldName,type:xtype,enumerable:xEnumerable},{col2}...{}]\r\n\t\t\t\t//returns {attribute1:emptyValue1,attribute2:emptyValue2...etc}\r\n\t\t\t\tvar newRow = {};\r\n\t\t\t\t_.each(columnsArr, function(element,index){\r\n\t\t\t\t\tvar fieldName = element.name;\r\n\t\t\t\t\tif(element.type==\"number\"){\r\n\t\t\t\t\t\tnewRow[fieldName] = 0;\r\n\t\t\t\t\t}else if(element.type==\"date\"){\r\n\t\t\t\t\t\tnewRow[fieldName] = new Date();\r\n\t\t\t\t\t}else if(element.type==\"enumerable\"){\r\n\t\t\t\t\t\tnewRow[fieldName] = '';\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tnewRow[fieldName] = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// FL.common.printToConsole(\"defaultNewGridRow newRow=\"+JSON.stringify(newRow));\r\n\t\t\t\t});\r\n\t\t\t\treturn newRow;\r\n\t\t\t},\r\n\t\t\tcreateEntityAndFields: function(entityName,entityDescription,fieldDefinitionArray) {//creates a dd entity with a set of fields \r\n\t\t\t\t//\tfieldDefinitionArray - array of JSON (one element per field) with format definition\r\n\t\t\t\t// format for fieldDefinitionArray -->[{label:\"xx\",name:fieldName, description:xdescription, type:xtype,enumerable:xEnumerable},{col2}...{}]\r\n\t\t\t\t//     NOTE:fieldDefinitionArray may come from  csvStore.getAttributesArr() or csvStore.getAttributesArrNoId()\r\n\t\t\t\t// Returns: true if createEntityAndFields succeeds - false if entityName already exists.\r\n\t\t\t\tvar xRet = false;\r\n\t\t\t\tif(FL.dd.createEntity(entityName, entityDescription)){//singular,description\r\n\t\t\t\t\t_.each(fieldDefinitionArray, function(element,index){\r\n\t\t\t\t\t\tFL.dd.addAttribute(entityName,element.name, element.description,element.label,element.type,element.typeUI,element.enumerable);\r\n\t\t\t\t\t});\r\n\t\t\t\t\txRet = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// alert(\"FL.dd.createEntityAndFields createEntity() Error entity \" + masterDetailItems.master.entityName + \" already exists !\");\r\n\t\t\t\t\tFL.common.printToConsole(\"FL.dd.createEntityAndFields Error:trying to create existing entity \" + entityName + \" !!!\");\r\n\t\t\t\t}\r\n\t\t\t\treturn xRet;\r\n\t\t\t},\r\n\t\t\trelationsOf: function(xSingular) {//returns an array with all relations of xSingular\r\n\t\t\t\t//\tformat of each array element:\r\n\t\t\t\t//\t{idRelation:3,cIdRelation:\"03\",rightEntity:\"Invoice\",description:\"has\",cardinality:\"0_1\",semantic:\"Client has many Invoices\"});\r\n\t\t\t\t//   one entity may have several relations with another entity !\r\n\t\t\t\tvar xComboArr=[];\r\n\t\t\t\t// var oEntity=dDictionary.entities[xSingular];\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\t\t\t\tif(oEntity){\r\n\t\t\t\t\tvar xArr=oEntity.relations;\r\n\t\t\t\t\tif(xArr.length>0){//entity has relations\r\n\t\t\t\t\t\tfor (var i=0;i<xArr.length;i++){\r\n\t\t\t\t\t\t\txComboArr.push(xArr[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn xComboArr;\r\n\t\t\t},\r\n\t\t\tremoveRelations: function(xSingular,sRightEntity) {//removes direct and reverse relations between the 2 entities\r\n\t\t\t\t//   removes relations sRightEntity from xSingular set of relations also removing\r\n\t\t\t\t// \t\trelations xSingular from sRightEntity set  of relations\r\n\t\t\t\t//   Notes:\r\n\t\t\t\t///  if xSingular or sRightEntity does not exists nothing is done\r\n\t\t\t\t//   this method assumes several relatiions between two entities\r\n\t\t\t\t//   if only one (direct or reverse) relation exist that relation will be removed\r\n\t\t\t\t\r\n\t\t\t\tvar oDirectEntity = this.entities[xSingular];\r\n\t\t\t\tvar oReverseEntity = this.entities[sRightEntity];\r\n\r\n\t\t\t\tif(oDirectEntity && oReverseEntity){\r\n\t\t\t\t\toDirectEntity.sync = false;\r\n\t\t\t\t\toReverseEntity.sync = false;\r\n\t\t\t\t\t// var xIndex=dDictionary.relationIndex(xSingular,sRightEntity);\r\n\t\t\t\t\tvar directRelationsArr = oDirectEntity.relations;//all direct relations - we need to isolate those with sRightEntity\r\n\t\t\t\t\tvar indexArr=[];\r\n\t\t\t\t\t_.each(directRelationsArr, function(element,index){\r\n\t\t\t\t\t\tif(element.rightEntity == sRightEntity)\r\n\t\t\t\t\t\t\tindexArr.push(index);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.each(indexArr, function(element){\r\n\t\t\t\t\t\toDirectEntity.relations.splice(element,1); //in position xIndex remove 1 item\r\n\t\t\t\t\t});\t\t\t\t\t\t\r\n\t\t\t\t\t// xIndex=dDictionary.relationIndex(sRightEntity,xSingular);\r\n\r\n\t\t\t\t\tvar reverseRelationsArr = oReverseEntity.relations;\r\n\t\t\t\t\tindexArr=[];\r\n\t\t\t\t\t_.each(reverseRelationsArr, function(element,index){\r\n\t\t\t\t\t\tif(element.rightEntity == xSingular)\r\n\t\t\t\t\t\t\tindexArr.push(index);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_.each(indexArr, function(element){\r\n\t\t\t\t\t\toReverseEntity.relations.splice(element,1); //in position xIndex remove 1 item\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tremoveEntity: function(xSingular) {//removes  entity xSingular in local dictionary\r\n\t\t\t\t//In order to remove an entity we begin by removing the relations of every direct relation of xSingular\tand also the inverse relations\r\n\t\t\t\t//\t\tthat other entities ,may have with xSingular\r\n\t\t\t\t//\tformat of each array element:\r\n\t\t\t\t// \t{idRelation:3,cIdRelation:\"03\",rightEntity:\"Invoice\",description:\"has\",cardinality:\"0_1\",semantic:\"Client has many Invoices\"});\r\n\t\t\t\t// var oEntity=dDictionary.entities[xSingular];\r\n\r\n\t\t\t\tvar oEntity = this.entities[xSingular];\r\n\r\n\t\t\t\tif(oEntity){//entity exists\r\n\t\t\t\t\tvar xRelArr=FL.dd.relationsOf(xSingular);//xRelArr has all relations that xSingular has woth other entities\r\n\t\t\t\t\tfor (var i=0;i<xRelArr.length;i++){\r\n\t\t\t\t\t\t//now deletes each relation (inverse and direct)\r\n\t\t\t\t\t\txRightEntity=xRelArr[i].rightEntity;\r\n\t\t\t\t\t\tif(xRightEntity)\r\n\t\t\t\t\t\t\tFL.dd.removeRelations(xSingular,xRightEntity);//this removes direct and inverse relations\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// delete dDictionary.entities[xSingular];//now that all relations are gone we can delete the entity\r\n\t\t\t\t\tdelete this.entities[xSingular];//now that all relations are gone we can delete the entity\r\n\t\t\t\t}else{\r\n\t\t\t\t\talert(\"dDictionary.removeEntity Error:Trying to remove a non existing entity:\"+xSingular);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetDictEntityBackup: function(entityName){//returns a copy of an whole entity (with all its internal objects) \r\n\t\t\t\tvar entityBackup = null;\r\n\t\t\t\tif( !_.isUndefined(this.entities[entityName]) ){\r\n\t\t\t\t\tvar oEntity = FL.dd.getEntityBySingular(entityName);\r\n\t\t\t\t\tentityBackup = _.clone(oEntity);\r\n\t\t\t\t\tvar C2LBackup = _.clone(oEntity.C2L);\r\n\t\t\t\t\tvar L2CBackup = _.clone(oEntity.L2C);\r\n\t\t\t\t\tvar attributesBackup = getDictAttributesBackup(oEntity.attributes);\r\n\t\t\t\t\tvar relationsBackup = _.clone(oEntity.relations);\r\n\r\n\t\t\t\t\tentityBackup.C2L = C2LBackup;\r\n\t\t\t\t\tentityBackup.L2C = L2CBackup;\r\n\t\t\t\t\tentityBackup.attributes = attributesBackup;\r\n\t\t\t\t\tentityBackup.relations = relationsBackup;\r\n\t\t\t\t}\r\n\t\t\t\treturn entityBackup;\r\n\t\t\t},\r\n\t\t\tinit_t:function(){\r\n\t\t\t\tFL.dd.t.entities = FL.dd.reverseEnt();\r\n\t\t\t},\r\n\t\t\tt: {\r\n\t\t\t\tentities: null,\r\n\t\t\t\tsave:function(){\r\n\t\t\t\t\treturn \"save done\";\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\treverseEnt:function(){\r\n\t\t\t\tvar z = {};\r\n\t\t\t\tvar oEntities = FL.dd.entities;\r\n\t\t\t\tFL.common.printToConsole(\"reverseEnt will process \"+(oEntities.__Last-9999)+\" entities..\",\"dd\");\r\n\t\t\t\t_.each(oEntities,function(value,key){//mounts a JSON whose keys are eCN -the loop has each entity\r\n\t\t\t\t\tif(key!=\"__Last\" && key!=\"__LastRelation\"){\r\n\t\t\t\t\t\tvar fieldsObj = {};\r\n\t\t\t\t\t\tvar thiz = this;\r\n\t\t\t\t\t\t_.each(value.attributes,function(element){//for each entity mounts a JSON whose keys are fCN\r\n\t\t\t\t\t\t\tvar fCN = value.L2C[element.name];\r\n\t\t\t\t\t\t\telement[\"parent\"] = key;\r\n\t\t\t\t\t\t\telement[\"disp\"] = function(x){return \"hello \"+x;};\r\n\t\t\t\t\t\t\telement[\"setField\"] = function(options){//options:(name,description,label,type,typeUI,enumerable)\r\n\t\t\t\t\t\t\t\tvar entityName = this.parent;\r\n\t\t\t\t\t\t\t\tvar fieldName = this.name;\r\n\t\t\t\t\t\t\t\tFL.common.printToConsole(\"--> saves -->FL.dd.t.entities[\" + value.csingular + \"].fields[\" + fCN + \"].setField(\" + JSON.stringify(options) + \")\",\"dd\");\r\n\r\n\t\t\t\t\t\t\t\tvar promise = FL.dd.updateAttribute(entityName,fieldName,options);\r\n\t\t\t\t\t\t\t\tpromise.done(function(dataArray){\r\n\t\t\t\t\t\t\t\t\tFL.dd.init_t();//update changes to FL.dd.t.entities\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tpromise.fail(function(err){\r\n\t\t\t\t\t\t\t\t\talert(\"FL.dd.t.entities[].fields[].setField() error impossible to update field attributes\");\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t});\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tfieldsObj[fCN] = element;\r\n\t\t\t\t\t\t\t// fieldsObj[\"disp\"] = function(x){return \"hello \"+x;};\r\n\t\t\t\t\t\t});\t\r\n\t\t\t\t\t\tvar properties = _.omit(value,\"lastId\",\"L2C\",\"C2L\",\"attributes\",\"relations\");\r\n\t\t\t\t\t\tproperties[\"fields\"] = fieldsObj;\r\n\t\t\t\t\t\tproperties[\"set\"] = function(options){\r\n\t\t\t\t\t\t\tvar entityName = this.singular;\r\n\t\t\t\t\t\t\tFL.dd.updateEntityBySingular(entityName,options);\r\n\t\t\t\t\t\t\tFL.dd.init_t();//update changes to FL.dd.t.entities\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tproperties[\"getFieldCName\"] = function(fieldName){//if field name does not exist returns null\r\n\t\t\t\t\t\t\tvar entityName = this.singular;\r\n\t\t\t\t\t\t\treturn FL.dd.getFieldCompressedName(entityName,fieldName);//returns null if entity name does not exist\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tproperties[\"fieldsList\"] = function(){\r\n\t\t\t\t\t\t\tvar fieldsListArr=[];\r\n\t\t\t\t\t\t\tvar oEntity = FL.dd.entities[this.singular];\r\n\t\t\t\t\t\t\tvar L2C = oEntity.L2C;\r\n\t\t\t\t\t\t\tif(oEntity){//if entity exists\r\n\t\t\t\t\t\t\t\t_.each(oEntity.attributes, function(element, index){\r\n\t\t\t\t\t\t\t\t\tif(element.name != \"id\"){\r\n\t\t\t\t\t\t\t\t\t\tvar el = {};\r\n\t\t\t\t\t\t\t\t\t\tel[\"fCN\"] = L2C[element.name];\r\n\t\t\t\t\t\t\t\t\t\tel[\"name\"] = element.name;\r\n\t\t\t\t\t\t\t\t\t\tel[\"description\"] = element.description;\r\n\t\t\t\t\t\t\t\t\t\tel[\"label\"] = element.label;\r\n\t\t\t\t\t\t\t\t\t\tel[\"statement\"] = attributeSemantics(element.name,element.description,oEntity,\"En\");\r\n\t\t\t\t\t\t\t\t\t\tel[\"type\"] = element.type;\r\n\t\t\t\t\t\t\t\t\t\tel[\"enumerable\"] = element.enumerable;\r\n\t\t\t\t\t\t\t\t\t\tel[\"typeUI\"] = element.typeUI;\r\n\t\t\t\t\t\t\t\t\t\tel[\"mask\"] = element.mask;\r\n\t\t\t\t\t\t\t\t\t\tel[\"specialTypeDef\"] = element.specialTypeDef;\r\n\t\t\t\t\t\t\t\t\t\t// ----\r\n\t\t\t\t\t\t\t\t\t\tfieldsListArr.push(el);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},this);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn fieldsListArr;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tproperties[\"addField\"] = function(name,description,label,type,typeUI,arrEnumerable){//if it exists update it otherwise a new is created\r\n\t\t\t\t\t\t\tFL.dd.addAttribute(this.singular,name,description,label,type,typeUI,arrEnumerable);\r\n\t\t\t\t\t\t\t// FL.dd.upsertAttribute(this.singular,name,options);\r\n\t\t\t\t\t\t\t//   options = {description:description,label:label,type:type, typeUI:typeUI,mask:mask,specialTypeDef:specialTypeDef,enumerable:arrEnumerable}\r\n\t\t\t\t\t\t\tFL.dd.init_t();//update changes to FL.dd.t.entities\r\n\t\t\t\t\t\t};\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tproperties[\"getCName\"] = function(fieldName){//if field name does not exist returns null\r\n\t\t\t\t\t\t\t// var entityName = \"sub\";//this.singular;\r\n\t\t\t\t\t\t\tvar entityName = value.singular;\r\n\t\t\t\t\t\t\treturn FL.dd.getFieldCompressedName(entityName,fieldName);//returns null if entity name does not exist\r\n\t\t\t\t\t\t};\t\r\n\t\t\t\t\t\tz[value.csingular] = properties;\r\n\t\t\t\t\t\t// this makes available: (code from bottom to top)\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].getCName(fieldName)\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].addField(name,description,label,type,typeUI,arrEnumerable)\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].fieldsList()\t\t\t\t\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].getFieldCName(fieldName)\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].set(options)\r\n\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].fields[<fCN>]\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].fields[<fCN>].parent  =>the logical name of <ecN>\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].fields[<fCN>].disp(x)  =>test returning \"hello\"+x\r\n\t\t\t\t\t\t//   FL.dd.t.entities[<eCN>].fields[<fCN>].setField(options) ->saves option in local and server\r\n\t\t\t\t\t}\t\r\n\t\t\t\t});\r\n\t\t\t\tz[\"add\"] = function(singular,description){\r\n\t\t\t\t\tFL.dd.createEntity(singular,description);\r\n\t\t\t\t\t//now we need to replicate it to the mockup structure - creating a new entry with the compressed name\r\n\t\t\t\t\tvar oEntity = FL.dd.entities[singular];\r\n\t\t\t\t\tvar eCN = FL.dd.getCEntity(singular);\r\n\t\t\t\t\tFL.dd.init_t();//update changes to FL.dd.t.entities\r\n\t\t\t\t\t// var newEntry = {};\r\n\t\t\t\t\t// newEntry[eCN] = {singular:oEntity.singular,csingular:oEntity.csingular,plural:oEntity.plural,description:oEntity.description,sync:oEntity.sync};\r\n\t\t\t\t\t// _.extend(FL.dd.t.entities,newEntry);\r\n\t\t\t\t};\r\n\t\t\t\tz[\"dumpToConsole\"] = function(){\r\n\t\t\t\t\tFL.dd.displayEntities();\r\n\t\t\t\t};\r\n\t\t\t\tz[\"list\"] = function(){\r\n\t\t\t\t\tvar listArr=[];\r\n\t\t\t\t\tvar oEntities = FL.dd.entities;\r\n\t\t\t\t\t_.each(oEntities,function(value,key){\r\n\t\t\t\t\t\tif(key!=\"__Last\" && key!=\"__LastRelation\"){\r\n\t\t\t\t\t\t\tlistArr.push(oEntities[key]);\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn listArr;\r\n\t\t\t\t};\r\n\t\t\t\tz[\"getCName\"] = function(entityName){//if entity name does not exist returns null\r\n\t\t\t\t\tvar oEntity=FL.dd.entities[entityName];\r\n\t\t\t\t\tif(FL.dd.entities[entityName])\r\n\t\t\t\t\t\treturn FL.dd.entities[entityName].csingular;\r\n\t\t\t\t\treturn null;//oEntity; //gives undefined\r\n\t\t\t\t};\r\n\t\t\t\t// z has all  FL.dd.t.entities[<eCN>]. methods and data and\r\n\t\t\t\t//\t\tFL.dd.t.entities.getName(entityName)\r\n\t\t\t\t//\t\tFL.dd.t.entities.list()\r\n\t\t\t\t//\t\tFL.dd.t.entities.dumpToConsole()\r\n\t\t\t\t//\t\tFL.dd.t.entities.add(singular,description)\r\n\t\t\t\treturn z;\r\n\t\t\t},\r\n\t\t\t// entity:{\r\n\t\t\t// \t\"50\":{\"singular\":\"customer\",disp:function(){return \"hello\";}},\r\n\t\t\t// \t\"60\":{\"singular\":\"contact\"}\r\n\t\t\t// },\r\n\t\t\t// ent.prototype:{\r\n\t\t\t// \tdisplay:function(){return this.arg1+\"/\"+this.arg2;};\r\n\t\t\t// },\r\n\t\t\t// e: new FL.dd.ent(),\r\n\t\t\tentityX: {//object model mockup\r\n\t\t\t\t// x: Object.create(FL.dd.ent),\r\n\t\t\t\t//example\r\n\t\t\t\t//\t\tvar display=null;\r\n\t\t\t\t// \t\t_.each(FL.dd.entityX.list(),function(element){display+=element.singular+\"/\"+element.csingular+\"\\n\"});\r\n\t\t\t\t// \t\talert(\"List all entities:\\n\"+display+\"\\nCompressed name of sub=\"+FL.dd.entityX.getCName(\"sub\"));\r\n\t\t\t\tadd:function(entityName,optionsObj){\r\n\t\t\t\t\talert(\"Entity \"+entityName+\" was created !\");\r\n\t\t\t\t\treturn \"50\";\r\n\t\t\t\t},\r\n\t\t\t\tsave:function(){\r\n\t\t\t\t\talert(\"entity.save() - Hello !\");\r\n\t\t\t\t},\r\n\t\t\t\tdump:function(){\r\n\t\t\t\t\tFL.dd.displayEntities();\r\n\t\t\t\t},\r\n\t\t\t\tgetCName:function(entityName){\r\n\t\t\t\t\tvar oEntity=FL.dd.entities[entityName];\r\n\t\t\t\t\tif(FL.dd.entities[entityName])\r\n\t\t\t\t\t\treturn FL.dd.entities[entityName].csingular;\r\n\t\t\t\t\treturn null;//oEntity; //gives undefined\r\n\t\t\t\t},\r\n\t\t\t\tlist:function(){\r\n\t\t\t\t\tvar listArr=[];\r\n\t\t\t\t\tvar oEntities = FL.dd.entities;\r\n\t\t\t\t\t_.each(oEntities,function(value,key){\r\n\t\t\t\t\t\tif(key!=\"__Last\" && key!=\"__LastRelation\"){\r\n\t\t\t\t\t\t\tlistArr.push(oEntities[key]);\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn listArr;\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\t\t\t\r\n\t\t};\r\n\t})();\r\n\t// FL.dd.t.entities.prototype.fullName = function() {\r\n\t//    return \"joao oliveira\";   \r\n\t// };\t\r\n// });"]}