{"version":3,"sources":["utils2.js"],"names":[],"mappings":"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","file":"utils2-compiled.js","sourcesContent":["window.utils = {\r\n\r\n    // Asynchronously load templates located in separate .html files\r\n    loadTemplate2: function(views, templates, callback) {//to each view must always correspond one template\r\n\r\n        var deferreds = [];\r\n\r\n        $.each(views, function(index, view) {\r\n            if (window[view]) {\r\n                FL.common.printToConsole(index+\" - carrega view=\"+view+\" with template \"+ 'tpl/' + templates[index] + '.html');\r\n                deferreds.push($.get('tpl/' + templates[index] + '.html', function(data) {//loads with jquery.get()\r\n                    // alert(\"data coming from \"+view+\":\\n\"+data);\r\n                    window[view].prototype.template = _.template(data);//view should match template names...\r\n                }));\r\n               FL.common.printToConsole(\"utils.loadTemplate-----ok--------->carregou view=\"+view);\r\n               // FL.common.printToConsole(\"utils.loadTemplate-----ok--------->carregou view=\"+view+\" com:\\n\"+data);\r\n               // alert(\"utils.loadTemplate-----ok--------->carregou view=\"+view+\" com:\\n\"+data);\r\n\r\n            } else {\r\n                alert(\"FrameLink could not find \" + view + \".html in directory 'tpl'\");\r\n            }\r\n        });\r\n\r\n        $.when.apply(null, deferreds).done(callback);\r\n    },\r\n        // window.mvt={\r\n        //     _no_model:{//these are fix templates withou any variable data\r\n        //         HeaderView:[\"HeaderView\"],\r\n        //         AboutView:[\"AboutView\"]\r\n        //     },\r\n        //     customer:{\r\n        //         customer_recordView:[\"customer_recordView_default\",\"customer_recordView_outsideAccess\"],\r\n        //         customer_gridView:[\"customer_gridView_default\"]\r\n        //     },\r\n        //     wine:{\r\n        //         wine_recordView:[\"wine_recordView_default\",\"wine_recordView_outsideAccess\"],\r\n        //         wine_gridView:[\"wine_gridView_default\"]\r\n        //     },\r\n        //     csv:{\r\n        //         wine_recordView:[\"CsvView\"]\r\n        //     }\r\n        // };\r\n   createView_Template: function(mvt,callback) {//to each view must always correspond one template\r\n        //Creates views for the mvt structure and loads templates from disk\r\n        //if a view has several templates (array.len>1) loadTemplates creates a duplicate of the base view with the same name as the yemplate\r\n        FL.common.printToConsole(\"--------------------------- load Template ----------------------------\");\r\n        var deferreds = [];\r\n\r\n        var thiz = this;\r\n        _.map( mvt, function( value, key ) {\r\n            var model = key;\r\n            FL.common.printToConsole(    \"_.---->Model=\"+ model);//\r\n            _.map( value, function( value, key ) {\r\n                var view = key;\r\n                var templateArr = value;\r\n                FL.common.printToConsole(\"_.----------View=\"+view+\"  tpl:-->\"+templateArr);// value is an array\r\n                _.each( templateArr, function( element, index ) {\r\n                    if (!window[view]) {//if the view does not exist, creates it\r\n                    // if (true) {//if the view does not exist, creates it\r\n                        thiz.createView(view,model);\r\n                    } else {\r\n                        FL.common.printToConsole(\"utils.loadTemplate-------------->existing view=\"+view);\r\n                        // FL.common.printToConsole(\"utils.loadTemplate-----ok--------->carregou view=\"+view+\" com:\\n\"+data);\r\n                         // FL.common.printToConsole(view+\"************>\"+index);\r\n                        // FL.common.printToConsole(\" ------------------> carrega view=\"+view+\" with template \"+ 'tpl/' + templates[key] + '.html');\r\n                     // FL.common.printToConsole(\"@@@@@ \"+index+\"------------------> carrega view=\"+view+\" with template \" + 'tpl/' + element + '.html');\r\n                        // deferreds.push($.get('tpl/' + templates[index] + '.html', function(data) {//loads with jquery.get()\r\n                        //     // alert(\"data coming from \"+view+\":\\n\"+data);\r\n                        //     window[view].prototype.template = _.template(data);//view should match template names...\r\n                        // }));\r\n                        // alert(\"utils.loadTemplate-----ok--------->carregou view=\"+view+\" com:\\n\"+data);\r\n                    \r\n                        // alert(\"FrameLink could not find \" + view + \".html in directory 'tpl'\");\r\n                    // FL.common.printToConsole(\"FrameLink could not find \" + view + \". It did not load \"+element+\".html in directory 'tpl'\");\r\n                    }\r\n                    // var x=deferreds; FL.common.printToConsole(\" inside template type of x=\" + utils.typeOf(x));\r\n                    thiz.createTemplate(element,view,model,deferreds);\r\n                });\r\n                // FL.common.printToConsole(    \"_.---->Value=\"+value);//\r\n            });\r\n        });\r\n        $.when.apply(null, deferreds).done(callback);\r\n        FL.common.printToConsole(\"--------------------------- load Template END------------------------\");\r\n    },\r\n    createView: function(view,model) {\r\n        FL.common.printToConsole(\"utils2.createView ------------------------------------------------------> creates view=\" + view + \" for model=\"+model);\r\n        if(model == \"_no_model\") {\r\n            window[view] = Backbone.View.extend({\r\n                initialize:function () {\r\n                    this.render();\r\n                },\r\n                render:function () {\r\n                    $(this.el).html(this.template());\r\n                    return this;\r\n                }\r\n            });\r\n        } else {\r\n            FL.common.printToConsole(\"we need to define a complex view in utils2.loadTemplate.createView()\");\r\n        }\r\n    },\r\n    createTemplate: function(template,view,model,deferreds){\r\n        FL.common.printToConsole(\"utils2.createTemplate ------------------------------------------------------------> creates template=\"+\r\n                    template + \" for view=\" + view + \" and model=\"+model);\r\n        FL.common.printToConsole(\" - carrega view=\"+view+\" with template \"+ 'tpl/' + template + '.html');\r\n        // var x=deferreds; FL.common.printToConsole(\" inside createTemplate type of x=\" + utils.typeOf(x));\r\n        deferreds.push($.get('tpl/' + template + '.html', function(data) {//loads with jquery.get()\r\n            if(window[view]) {\r\n                window[view].prototype.template = _.template(data);//view should match template names...\r\n            }else{\r\n                alert(\"createTemplate Error: Cannot load template tpl/\" + template + \".html, because the view \" + view + \" does not exist !!!\");\r\n            }\r\n        }));\r\n    },\r\n    uploadFile: function (file, callbackSuccess) {\r\n        var self = this;\r\n        var data = new FormData();\r\n        data.append('file', file);\r\n        $.ajax({\r\n            url: 'api/upload.php',\r\n            type: 'POST',\r\n            data: data,\r\n            processData: false,\r\n            cache: false,\r\n            contentType: false\r\n        })\r\n        .done(function () {\r\n            FL.common.printToConsole(file.name + \" uploaded successfully\");\r\n            callbackSuccess();\r\n        })\r\n        .fail(function () {\r\n            self.showAlert('Error!', 'An error occurred while uploading ' + file.name, 'alert-error');\r\n        });\r\n    },\r\n\r\n    displayValidationErrors: function (messages) {\r\n        for (var key in messages) {\r\n            if (messages.hasOwnProperty(key)) {\r\n                this.addValidationError(key, messages[key]);\r\n            }\r\n        }\r\n        this.showAlert('Warning!', 'Fix validation errors and try again', 'alert-warning');\r\n    },\r\n\r\n    addValidationError: function (field, message) {\r\n        var controlGroup = $('#' + field).parent().parent();\r\n        controlGroup.addClass('error');\r\n        $('.help-inline', controlGroup).html(message);\r\n    },\r\n\r\n    removeValidationError: function (field) {\r\n        var controlGroup = $('#' + field).parent().parent();\r\n        controlGroup.removeClass('error');\r\n        $('.help-inline', controlGroup).html('');\r\n    },\r\n\r\n    showAlert: function(title, text, klass) {\r\n        $('.alert').removeClass(\"alert-error alert-warning alert-success alert-info\");\r\n        $('.alert').addClass(klass);\r\n        $('.alert').html('<strong>' + title + '</strong> ' + text);\r\n        $('.alert').show();\r\n    },\r\n\r\n    hideAlert: function() {\r\n        $('.alert').hide();\r\n    },\r\n    is_email: function(email) {\r\n        var re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n        return re.test(email);\r\n    },\r\n    is_url: function(url) {\r\n        // var re = /(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?/;\r\n        // var re = /((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\\+\\$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[\\+~%\\/.\\w-_]*)?\\??(?:[-\\+=&;%@.\\w_]*)#?(?:[\\w]*))?)/;\r\n        // var re= /^[a-z](?:[-a-z0-9\\+\\.])*:(?:\\/\\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:])*@)?(?:\\[(?:(?:(?:[0-9a-f]{1,4}:){6}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|::(?:[0-9a-f]{1,4}:){5}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:[0-9a-f]{1,4}:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+[-a-z0-9\\._~!\\$&'\\(\\)\\*\\+,;=:]+)\\]|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3}|(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=@])*)(?::[0-9]*)?(?:\\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@]))*)*|\\/(?:(?:(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@]))+)(?:\\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@]))*)*)?|(?:(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@]))+)(?:\\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@]))*)*|(?!(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@])))(?:\\?(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@])|[\\x{E000}-\\x{F8FF}\\x{F0000}-\\x{FFFFD}|\\x{100000}-\\x{10FFFD}\\/\\?])*)?(?:\\#(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\\._~\\x{A0}-\\x{D7FF}\\x{F900}-\\x{FDCF}\\x{FDF0}-\\x{FFEF}\\x{10000}-\\x{1FFFD}\\x{20000}-\\x{2FFFD}\\x{30000}-\\x{3FFFD}\\x{40000}-\\x{4FFFD}\\x{50000}-\\x{5FFFD}\\x{60000}-\\x{6FFFD}\\x{70000}-\\x{7FFFD}\\x{80000}-\\x{8FFFD}\\x{90000}-\\x{9FFFD}\\x{A0000}-\\x{AFFFD}\\x{B0000}-\\x{BFFFD}\\x{C0000}-\\x{CFFFD}\\x{D0000}-\\x{DFFFD}\\x{E1000}-\\x{EFFFD}!\\$&'\\(\\)\\*\\+,;=:@])|[\\/\\?])*)?$/i;\r\n        // var re = /^(ht|f)tps?:\\/\\/[a-z0-9-\\.]+\\.[a-z]{2,4}\\/?([^\\s<>\\#%\"\\,\\{\\}\\\\|\\\\\\^\\[\\]`]+)?$/;\r\n        var re =/^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!10(?:\\.\\d{1,3}){3})(?!127(?:\\.\\d{1,3}){3})(?!169\\.254(?:\\.\\d{1,3}){2})(?!192\\.168(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/i;\r\n        return re.test(url);\r\n    },\r\n    typeOf: function(xVar) {//returns one of :  \"number\",\"string\",\"boolean\",\"object\",\"array\",\"null\",\"undefined\",\"date\"\r\n        //exemple of undefined: a variable declared but never defined -->var foo; alert(foo); //undefined.\r\n        var xRet = typeof xVar;\r\n        if(xRet == \"object\") {\r\n            if (xVar instanceof Array)\r\n                xRet=\"array\";\r\n            if (xVar instanceof Date)\r\n                xRet=\"date\";\r\n            if (!xVar)\r\n                xRet=\"null\";\r\n        // }else if(xRet == \"string\"){\r\n        //     if(this.is_email(xVar))\r\n        //         xRet=\"email\";\r\n        }\r\n        return xRet;\r\n    },\r\n    typeUIOf: function(xVar) {//for string type returns one of the typeUI \"email\", \"url\", \"phone\"etc. If not string returns null\r\n        // used in FL.grid   private function  is_ColumnOfSubtype(subtype,sampleArr)\r\n        var subtype = null;\r\n        var xtype = typeof xVar;\r\n        if(xtype == \"string\") {\r\n            if(this.is_email(xVar))\r\n                subtype=\"email\";\r\n            else if(this.is_url(xVar))\r\n                subtype=\"url\";\r\n            else if(FL.common.is_phone(xVar))\r\n                subtype=\"phone\";\r\n        }\r\n        return subtype;\r\n    },\r\n    arrayToLower: function(list){\r\n        return _.map(list,function(element,index){\r\n            return(element.toLowerCase());\r\n        });\r\n    },\r\n    createEntityFromCsvAnalisys: function(rows){//creates a dd entry from a set of rows\r\n        var entityName = \"unNamed\";\r\n        //this new entity will be called \"unNamed\" + <num> - we need to evaluate how many unNamed<#> are already in dd.\r\n        entityName = FL.dd.nextEntityBeginningBy(entityName);\r\n        // FL.dd.createEntity(\"Client152\",\"Individual or Company to whom we may send invoices\");//singular, plural, description\r\n        if(!FL.dd.createEntity(entityName,\"temporary name for imported entity\"))//singular,description\r\n            alert(\"createEntityFromCsvAnalisys Error entity \" + entityName + \" already exists !\");\r\n        // this.checkTypesForArrayOfObjects(rows);\r\n        var arrOfAttributes = this.firstRowAnalisys(rows, 0.5);\r\n        _.each(arrOfAttributes, function(element,index){\r\n            var attrName = _.keys(element)[0];\r\n            var fieldType =element[attrName].fieldType;\r\n            var label =element[attrName].label;\r\n            var enumerable = null;\r\n            if(fieldType==\"enumerable\"){\r\n                enumerable = element[attrName].enumerable;\r\n            }\r\n            // FL.common.printToConsole(index+\" - createEntityFromCsvAnalisys -->\"+attrName +\" type=\"+fieldType+\" label=\"+label );\r\n            FL.dd.addAttribute(entityName, attrName,entityName+\"' \"+attrName,label,fieldType,fieldTypeUI,enumerable);//xEntity,xAttribute,xDescription,xLabel,xType,xEnumerable\r\n        });\r\n        return entityName;\r\n    },\r\n    xbackGridColumnsExtractedFromDictionary: function(entityName){//prepares a columns object for backgrid\r\n        //first column has a delete button, second a non editable  id then the others       \r\n        var oEntity = FL.dd.getEntityBySingular(entityName);\r\n        // alert(\"backGridColumnsExtractedFromDictionary ->\"+JSON.stringify(oEntity.attributes));\r\n        return this.backGridColumnsFromArray(oEntity.attributes);\r\n    },\r\n    backGridColumnsFromArray: function(arrOfColumns){//prepares a columns object for backgrid\r\n        //arrOfColumns has the format: [{label:\"xx\",name:fieldName,type:xtype,enumerable:xEnumerable},{col2}...{}]\r\n        //    label ->The column Label\r\n        //    name -> the field name stored in csvStore (csvStore.csvRows) - one name must be called id (second columns) non-editable\r\n        //    type -> the type of content (string, number etc...)\r\n        //      if xtype!=\"enumerable\" =>xEnumerable = null \r\n        //      if xtype=\"enumerable\" =>xEnumerable = array with enumerable elements\r\n        //    ewnumerable -> null or an array of enumerable elements\r\n        //first column has a delete button, second a non editable  id then the others \r\n\r\n        // http://amiliaapp.github.io/backgrid-select-filter/   - filter\r\n        //https://bugcode.wordpress.com/2013/09/12/adding-action-function-as-a-listener-of-grid-using-backgrid/   - date\r\n        //http://www.snip2code.com/Snippet/171272/backgrid-datetimepicker-cell-with-bootst date\r\n        //http://backgridjs.com/ref/extensions/moment-cell.html - http://momentjs.com/docs/ - date\r\n        //http://www.pythoneye.com/54_23092624/ image cell type\r\n        //http://www.lostiemposcambian.com/blog/javascript/backgrid-componente-datagrid-para-backbone/ image\r\n        //http://vimeo.com/32765088\r\n        //http://handsontable.com/demo/backbone.html\r\n        //http://amiliaapp.github.io/backgrid-object-cell/\r\n        //https://github.com/DJCrossman/backgrid-subgrid-cell\r\n        //http://blog.joshsoftware.com/2011/09/28/filter-js-client-side-search-filtering-using-json-and-jquery/\r\n        //http://techwuppet.com/backgrid_poc_demo/ - resize columns, search\r\n        //http://stackoverflow.com/questions/17940454/how-to-delete-select-all-and-select-row-in-backgrid-js\r\n        var DeleteCell = Backgrid.Cell.extend({\r\n            template: _.template($(\"#gridDelButton\").html()),\r\n            className: \"backgridDelColumn\",\r\n            events: {\r\n                \"click\": \"deleteRow\"\r\n            },\r\n            deleteRow: function (e) {\r\n                e.preventDefault();\r\n                // alert(\"we will remove \"+this.model.get(\"id\"));\r\n                // csvSetCollection.sync(\"delete\",this.model);\r\n                this.model.collection.sync(\"delete\",this.model);\r\n                this.model.collection.remove(this.model);\r\n            },\r\n            render: function () {\r\n                this.$el.html(this.template());\r\n                this.delegateEvents();\r\n                return this;\r\n            }\r\n        });\r\n        // var columns = [{name: \"del\", label: \"Delete\", cell: DeleteCell }];\r\n\r\n        // var SelectAllHeaderCell = Backgrid.HeaderCell.extend({\r\n        //     // Implement your \"select all\" logic here\r\n        // });\r\n        // var columns = [{name: \"del\", label: \"Delete\", cell: DeleteCell },{name:\"\",cell:\"select-row\",headerCell: \"select-all\"}];\r\n        var columns = [{name:\"\",cell:\"select-row\",headerCell: \"select-all\"}];\r\n        //http://pastie.org/pastes/8312516\r\n        var DialogButtonCell = Backgrid.Cell.extend({\r\n            title: 'Title',\r\n            allowCancel: true,\r\n            cancelButtonType: 'danger',\r\n            okButtonType: 'success',\r\n            getDialog: function() {\r\n              var dialogClass = this.dialogClass;\r\n              var dialog = new dialogClass();\r\n              return dialog;\r\n            },\r\n            onClick: function() {\r\n              var dialog = this.getDialog();\r\n              dialog.show();\r\n            },\r\n            onOk: function(e) {},\r\n        });\r\n        DateTimePickerCellEditor = Backgrid.InputCellEditor.extend({\r\n            events: {},\r\n            initialize:function(){\r\n                Backgrid.InputCellEditor.prototype.initialize.apply(this, arguments);\r\n                var input = this;\r\n                $(this.el).datetimepicker({\r\n                    format: false,\r\n                    useCurrent:true\r\n                }).on('dp.show', function(e) {//necessary to convert \r\n                    FL.common.printToConsole(\"show calendar !!!\",\"util\");\r\n                    var z=  e.target.value;\r\n                    FL.common.printToConsole(\"--->\"+z,\"util\");\r\n                    // alert(\"dp.show\");\r\n                    $(this.el).data(\"DateTimePicker\").setMinDate(e.date);\r\n                }).on('dp.hide', function(e) {\r\n                    e.preventDefault();\r\n                    var command = new Backgrid.Command({});\r\n                    input.model.set(input.column.get(\"name\"), e.date.format('YYYY-MM-DD'));\r\n                    input.model.trigger(\"backgrid:edited\", input.model, input.column, command);\r\n                    command = input = null;\r\n                });\r\n            }\r\n        });\r\n        MyDatePickerCellEditor = Backgrid.InputCellEditor.extend({\r\n            events:{},\r\n            initialize:function(){\r\n                //https://github.com/eternicode/bootstrap-datepicker - the code is in bootstrap-editable.js and css in bootstrap-editable.css\r\n                //http://jsfiddle.net/qiruiwei/B4BzK/\r\n                Backgrid.InputCellEditor.prototype.initialize.apply(this, arguments);\r\n                var input = this;\r\n                var columnName = input.column.get(\"name\");\r\n                var currentDateValue = this.model.attributes[columnName];\r\n                window.currentDateValue = currentDateValue;//terrible HACK !!!\r\n                window.input = input;//terrible HACK !!!\r\n                $(this.el).datepicker({\r\n                    autoclose: true,\r\n                    todayBtn: \"linked\",\r\n                    format: \"yyyy-M-dd\",//the format that will be displayed after we select a date in calendar              \r\n                    // onClose: function(newValue){\r\n                    //     var command = new Backgrid.Command({});\r\n                    //     input.model.set(input.column.get(\"name\"), newValue);\r\n                    //     input.model.trigger(\"backgrid:edited\", input.model, input.column, command);\r\n                    //     command = input = null;\r\n                    //     // alert(\"On close MyDatePickerCellEditor\");\r\n                    //     this.render();\r\n                    // }\r\n                }).on('show', function(ev) {//necessary to convert \r\n                    FL.common.printToConsole(\"show calendar !!!\");\r\n                    var z=  ev.target.value;\r\n                    FL.common.printToConsole(\"--->\"+z);\r\n                    // ev.target.value = window.currentDateValue;////terrible HACK !!!\r\n                    var formatedValue = window.input.formatter.fromRaw(window.currentDateValue.toISOString());\r\n                    ev.target.value = formatedValue;////terrible HACK !!!\r\n                }).on('hide', function(ev) {\r\n                    var formatedValue = ev.target.value;\r\n                    var newDateValue = new Date(formatedValue);\r\n                    //if only date is selected we will consider mid day\r\n                    if( newDateValue.getHours() === 0 && newDateValue.getMinutes() === 0 && newDateValue.getSeconds() === 0 && newDateValue.getMilliseconds() === 0){\r\n                        newDateValue.setHours(12);\r\n                    }\r\n                    input.model.set(input.column.get(\"name\"),newDateValue);\r\n                    FL.common.printToConsole(\"hide calendar !!!\");\r\n                });\r\n                // $(this.el).datepicker(\"setDate\",new Date(2006, 11, 24));\r\n                $(this.el).datepicker(\"setDate\", currentDateValue);\r\n                $(this.el).datepicker(\"update\");\r\n                // $('.datepicker').datepicker().on(\"changeDate\", function(e){\r\n                //     //# `e` here contains the extra attributes\r\n                // });\r\n                // $( \".datepicker prev icon-arrow-left\" ).addClass( \"glyphicon arrow-left\" );\r\n\r\n                FL.common.printToConsole(\"datepicker initialize()\");\r\n                var z=32;\r\n            },\r\n        });\r\n        DateCell =Backgrid.Cell.extend({editor: DateTimePickerCellEditor});\r\n        // DateCell =Backgrid.Cell.extend({\r\n        //     editor: DateTimePickerCellEditor,\r\n        //     render: function () {\r\n        //         var colContent = this.model.get(this.column.get(\"name\"));\r\n        //         var formatedValue = this.formatter.fromRaw(colContent);\r\n        //         FL.common.printToConsole(\"render----->\"+colContent + \" formated->\"+formatedValue,\"util\");\r\n        //         this.$el.html(colContent);\r\n        //         this.delegateEvents();\r\n        //         return this;\r\n        //     }\r\n        // });\r\n        var jqDateTimePickerCellEditor = Backgrid.InputCellEditor.extend({\r\n            //http://stackoverflow.com/questions/30115158/check-if-backgrid-cell-was-edited\r\n            events : {\r\n                \"change .datePicker\" : \"onDatePickerValueChange\"\r\n            },            \r\n            initialize:function(){\r\n                Backgrid.InputCellEditor.prototype.initialize.apply(this, arguments);\r\n                var input = this;\r\n                $(this.el).datetimepicker({\r\n                    timeFormat: \"hh:mm tt\",\r\n                    controlType: 'select',\r\n                    oneLine: true,\r\n                    onClose: function(dateText,inst) {//an event belonging to the widget\r\n                      alert(\"close !!!\");\r\n                    },\r\n                    onSelect: function(selectedDateTime){\r\n                        alert(\"select\");\r\n                        // startDateTextBox.datetimepicker('option', 'maxDate', endDateTextBox.datetimepicker('getDate') );\r\n                    }\r\n                });\r\n            },\r\n            onDatePickerValueChange : function(){\r\n                alert(\"jqDateTimePickerCellEditor CHANGE !!!\");\r\n            },\r\n            onRender: function(){\r\n                $(this.el).datetimepicker({\r\n                    timeFormat: \"hh:mm tt\",\r\n                    controlType: 'select',\r\n                    oneLine: true,\r\n                });\r\n            }\r\n        });\r\n        var jqPhoneCellEditor = Backgrid.InputCellEditor.extend({\r\n            //https://github.com/Bluefieldscom/intl-tel-input\r\n            tagName:\"div\",\r\n            //el:'#phoneInput',\r\n            initialize:function(){\r\n                Backgrid.InputCellEditor.prototype.initialize.apply(this, arguments);\r\n                // var input = this;\r\n                //if views el,tagName, className, id or attributes properties are'nt specified, then this.el is an empty div.\r\n                // The view.$el its a cached jQuery object of the views element (view.el). \r\n                //<input type=\"tel\" id=\"demo\" placeholder=\"\">\r\n                //$(\"#demo\").intlTelInput();\r\n                // $(this.el).empty();\r\n                // $(this.el).append($('#phoneInputTemplate').html());\r\n                // $(this.el).intlTelInput({//http://www.jqueryscript.net/form/jQuery-International-Telephone-Input-With-Flags-Dial-Codes.html\r\n                var template = $(\"#phoneInputTemplate\").html();\r\n                $(this.el).html(template);\r\n                $('#phoneInput').intlTelInput({//http://www.jqueryscript.net/form/jQuery-International-Telephone-Input-With-Flags-Dial-Codes.html\r\n                    autoPlaceholder: true,\r\n                    preferredCountries: [ \"us\", \"gb\" ]\r\n                 });\r\n            },\r\n            render: function(){\r\n                //$(this.el).intlTelInput({\r\n                $('#phoneInput').intlTelInput({\r\n                    autoPlaceholder: true,\r\n                    preferredCountries: [ \"us\", \"gb\" ]\r\n                });\r\n            }   \r\n        });\r\n         // var DateCell = \"string\";\r\n        var BooleanCell = Backgrid.BooleanCell.extend({\r\n            //http://stackoverflow.com/questions/28368744/avoid-clicking-twice-to-begin-editing-boolean-checkbox-cell-in-backgrid/28420049#28420049\r\n            editor: Backgrid.BooleanCellEditor.extend({\r\n                render: function () {\r\n                    var model = this.model;\r\n                    var columnName = this.column.get(\"name\");\r\n                    var val = this.formatter.fromRaw(model.get(columnName), model);\r\n\r\n                    /*\r\n                     * Toggle checked property since a click is what triggered enterEditMode\r\n                    */\r\n                    this.$el.prop(\"checked\", !val);\r\n                    model.set(columnName, !val);\r\n\r\n                    return this;\r\n                }\r\n            })\r\n        });\r\n\r\n\r\n        var EmailCell = Backgrid.EmailCell.extend({\r\n            className: \"email-cell\",\r\n            validate: function(newval){\r\n                alert(\"inside email validate with \"+newval+\" !!!\");\r\n                return true;\r\n            },\r\n            render: function () {\r\n                this.$el.empty();\r\n                var formattedValue = this.formatter.fromRaw(this.model.get(this.column.get(\"name\")));\r\n                this.$el.append($(\"<a>\", {\r\n                    tabIndex: -1,\r\n                    // href: \"mailto:\" + formattedValue,\r\n                    title: formattedValue\r\n                }).text(formattedValue));\r\n                this.delegateEvents();\r\n                return this;\r\n            }\r\n        });\r\n        var DateTimeCell = Backgrid.Extension.MomentCell.extend({\r\n            modelInUTC: true,\r\n            modelFormat: \"YYYY-MM-DDTHH:mm:ss.SSSZ\",\r\n            displayFormat: \"MMMM Do YYYY, h:mm:ss a\",\r\n            displayInUTC: false\r\n            // render: function() {\r\n            //   Backgrid.Extension.MomentCell.prototype.render.call(this);\r\n            //   this.$el.addClass('friendly-datetime-cell');\r\n            //   return this;\r\n            // },\r\n          });\r\n\r\n        // columns.push({name: \"diag\", label: \"Dialog\", cell: DialogButtonCell });\r\n        // var MomentCell = Backgrid.Extension.MomentCell.extend({\r\n        //     modelFormat: \"YYYY/M/D\",\r\n        //     displayFormat: \"YYYY-MMM-DD\",\r\n        // });\r\n        // var oEntity = FL.dd.getEntity(entityName);\r\n        _.each(arrOfColumns, function(element,index){\r\n            FL.common.printToConsole(\"utils2 backGridColumnsFromArray defaultEntityColumns *********************--->\"+element.name,\"util\");\r\n            var column = {};\r\n            column[\"name\"] = element.name;\r\n            if( element.name==\"id\" ) {\r\n                column[\"editable\"] = false;\r\n                column[\"label\"] = element.label;\r\n                column[\"cell\"] = Backgrid.IntegerCell.extend({ orderSeparator: '' });\r\n                // column[\"cell\"] = Backgrid.IntegerCell.extend({ className:'bacgridId',orderSeparator: '' });\r\n            }else if(element.type==\"string\" && element.typeUI==\"combobox\"){\r\n                var enumValues = _.map(element.enumerable, function(element){ return [element,element]; });\r\n                // var MySelect2Cell = Backgrid.Extension.Select2Cell.extend({\r\n                var MySelectCell = Backgrid.SelectCell.extend({\r\n                    select2Options: {openOnEnter: false},\r\n                    optionValues: enumValues\r\n                 });\r\n                column[\"label\"] = element.label;\r\n                column[\"cell\"] = MySelectCell;\r\n            }else if(element.type==\"string\" && (element.typeUI==\"email\" || element.typeUI==\"emailbox\") ){\r\n                column[\"label\"] = element.label;\r\n                column[\"cell\"] = EmailCell;\r\n            }else{\r\n                // ex {label:\"Col4\",name:\"f4\",type:\"integer\",enumerable:null}, \"date\", \"url\"\r\n                //     \"number\",\"string\",\"email\",\"boolean\",\"object\",\"array\",\"null\",\"undefined\"\r\n                //http://backgridjs.com/ref/cell.html\r\n                column[\"label\"] = element.label;\r\n                if(element.type==\"number\"){\r\n                    column[\"cell\"] = \"number\";// A cell type for floating point value, defaults to have a precision 2 decimal numbers  \r\n                }else if(element.type==\"integer\"){\r\n                    column[\"cell\"] = \"integer\";//An integer cell is a number cell that displays humanized integers\r\n                }else if(element.type==\"date\"){\r\n                    column[\"cell\"] = DateCell;//MyDatePickerCell;\r\n                 }else if(element.type==\"url\"){\r\n                    column[\"cell\"] = \"url\";\r\n                }else{\r\n                    column[\"cell\"] = \"string\";\r\n                }\r\n            }\r\n            columns.push(column);\r\n        });\r\n        return columns;\r\n    },\r\n    defaultNewGridRow: function(columnsArr,last){//returns an array of fields with empty content\r\n        // columnsArr is columns definition to mountGrid. Format: [{label:\"xx\",name:fieldName,type:xtype,enumerable:xEnumerable},{col2}...{}]\r\n        var newRow = {};\r\n        _.each(columnsArr, function(element,index){\r\n            var fieldName = element.name;\r\n            if( fieldName ==\"id\" ) {\r\n                newRow[fieldName] = last;\r\n             }else if(element.type==\"enumerable\"){\r\n                newRow[fieldName] = '';\r\n            }else{\r\n                newRow[fieldName] = '';\r\n            }\r\n           FL.common.printToConsole(\"defaultNewGridRow newRow=\"+JSON.stringify(newRow));\r\n        });\r\n        return newRow;\r\n    },\r\n    prepareColArrForClientSideFilter: function(backgridColumnsArr){\r\n        var filterFieldsArr = [];\r\n        _.each(backgridColumnsArr, function(element,index){\r\n            if(index>1){//skips select-all and id columns\r\n                filterFieldsArr.push(element.name);\r\n            }\r\n        });\r\n        return filterFieldsArr;\r\n    },\r\n    mountGridInCsvStore: function(columnsArr) {//creates backbone classes and uses them\r\n        // columnsArr is columns definition to mountGrid. \r\n        //      Format: [{label:\"xx\",name:fieldName,type:xtype,enumerable:xEnumerable},{col2}...{}]\r\n        //Classes: Model ->CsvElement, Collection ->CsvSet\r\n        //Instances:                  , collection ->csvSetCollection\r\n        var myColumns = new Backgrid.Columns(columnsArr);\r\n        Backbone.sync = csvStore.sync;\r\n\r\n        var CsvElement = Backbone.Model.extend({\r\n            initialize: function () {\r\n                FL.common.printToConsole(\"initializing CsvElement model\");\r\n                this.on('change',this.modelUpdate,this);\r\n                this.on('add',this.modelAdd,this);\r\n            },\r\n            modelUpdate: function(){\r\n                // alert(\"CsvElement modelUpdate !!!! --->\"+ this.get(\"id\") + \" _id=\"+ this.get(\"_id\") + \" nome=\"+this.get(\"nome\"));\r\n                // alert(\"CsvElement modelUpdate !!!! --->\"+ JSON.stringify(this.toJSON()));\r\n                csvSetCollection.sync(\"update\",this);\r\n            },\r\n            modelAdd: function(){\r\n                // alert(\"CsvElement modelUpdate !!!! --->\"+ this.get(\"id\") + \" _id=\"+ this.get(\"_id\") + \" nome=\"+this.get(\"nome\"));\r\n                // alert(\"CsvElement modelAdd !!!! --->\"+ JSON.stringify(this.toJSON()));\r\n                FL.common.printToConsole(\"mountGridInCsvStore CsvElement Add model id=\"+this.id+\" marca=\"+this.attributes.marca+\" _id=\"+this.attributes._id);\r\n\r\n            },\r\n            // sync:csvStore.sync\r\n            sync:function(method, model, options){\r\n                return csvStore.sync(method, model, options);\r\n            }\r\n        });//every row is a model object\r\n        var CsvSet = Backbone.Collection.extend({//the whole table is backed by a simple Backbone collection\r\n            model: CsvElement,\r\n        });\r\n        var csvSetCollection = new CsvSet(csvStore.csvRows);//We can instantiate our new collection by passing in an array of models.       \r\n        csvSetCollection.fetch({remove:false,success: function(){\r\n            FL.common.printToConsole(\" csvSetCollection.fetch ==========================================> success !!!\");\r\n        },error:function(){\r\n            FL.common.printToConsole(\" csvSetCollection.fetch ==========================================> ERROR !!!\");\r\n        }});\r\n\r\n        var CsvPageableCollection = Backbone.PageableCollection.extend({\r\n            state: {\r\n                pageSize: 10,\r\n                // sortKey: \"updated_at\",\r\n                order: 1\r\n            },\r\n            sync:function(method, model, options){\r\n                return csvStore.sync(method, model, options);\r\n            },\r\n            mode: \"client\",\r\n            model: CsvElement //necessary for update\r\n        });\r\n        var csvPageableCollection = new CsvPageableCollection();\r\n\r\n        // ClientSideFilter performs a case-insensitive regular\r\n        // expression search on the client side by OR-ing the keywords in\r\n        // the search box together.\r\n        //https://gist.github.com/martindrapeau/9812237\r\n        var clientSideFilter = new Backgrid.Extension.ClientSideFilter({\r\n          collection: csvPageableCollection,\r\n          placeholder: \"Search in any column\",\r\n          // The model fields to search for matches\r\n          // fields: ['Name','birth date','email'],\r\n          fields: utils.prepareColArrForClientSideFilter(columnsArr),\r\n          // How long to wait after typing has stopped before searching can start\r\n          wait: 150,\r\n        });\r\n        // $(\"#client-side-filter-example-result\").prepend(clientSideFilter.render().el);\r\n\r\n        // var z=32;\r\n        var grid = new Backgrid.Grid({\r\n            // row:ClickableRow,\r\n            columns:myColumns,\r\n            // collection:csvSetCollection //grid without paginator\r\n            collection:csvPageableCollection //<-------------- necessary for pagination !!!!\r\n        });\r\n        var paginator = new Backgrid.Extension.Paginator({\r\n            // windowSize: 20, // Default is 10\r\n            collection: csvPageableCollection // the collection subclass that supports pagination\r\n        });\r\n        csvPageableCollection.on('backgrid:selected', function(model, selected) {\r\n            FL.common.printToConsole(\"model--->\"+model,\"util\");\r\n            // $(\".backgrid\").before(\"<p style='padding-top:30px;float:right;margin-right:800px'>abcde</p>\");\r\n        });\r\n        $(\"#_belowMenus\").show();\r\n        this.placeGridButtonsInDOM(csvSetCollection,csvPageableCollection,grid);\r\n        $(\"#grid\").prepend(clientSideFilter.render().el);\r\n        $(\"#grid\").append(grid.render().$el);\r\n        // $(\".backgrid\").before(\"<p style='padding-top:30px;float:right;margin-right:800px'>abcde</p>\");\r\n        // $(\"#csvcontent\").append(grid.render().el);\r\n        $(\"#paginator\").append(paginator.render().$el);\r\n        csvPageableCollection.fetch();\r\n        return grid;\r\n    },\r\n    placeGridButtonsInDOM: function(csvSetCollection,csvPageableCollection,grid){\r\n        $(\"#csvcontent\").empty();\r\n        $('#addGrid').off('click');\r\n        $(\"#addGrid\").click(function () {\r\n            csvStore.addOneEmptyRow();\r\n            var lastKeyInStore = csvStore.getNextId() - 1; //get the highest key in csvStore.csvRows\r\n            var CsvElementModel = Backbone.Model.extend({});\r\n\r\n            newRow = csvStore.csvRows[lastKeyInStore];\r\n            var csvLine = new CsvElementModel(newRow);\r\n\r\n            csvSetCollection.add(newRow);//grid without paginator - collection does not have a save method\r\n            csvPageableCollection.getLastPage();//we force lastKeyInStorePage display !!! - remove this line if no paginator\r\n            csvPageableCollection.add(newRow);//the new model was inserted in the collection <--- necessary for paginator - - remove this line if no paginator\r\n\r\n            csvLine.sync(\"create\",newRow);\r\n\r\n            grid.insertRow(csvLine);\r\n        });\r\n        $('#_delete').off('click');\r\n        $('#_delete').show();\r\n        $(\"#_delete\").click(function () {\r\n            var selectedModels = grid.getSelectedModels();\r\n            if(selectedModels.length > 0 ){\r\n                var preStr = selectedModels.length + \" row\";\r\n                if (selectedModels.length > 1)\r\n                    preStr +=\"s\";\r\n                FL.common.makeModalConfirm(  preStr + \" will be deleted. Do you confirm ?\",\"No, cancel delete\",\"Yes delete\",function(result){\r\n                    if(result){\r\n                        var arrOf_Ids = [];\r\n                        _.each(selectedModels, function (model) {\r\n                            arrOf_Ids.push(model.attributes._id);\r\n                            model.destroy();\r\n                        });\r\n                        var promise=FL.API.removeRecordFromTable(csvStore.getEntityName(),arrOf_Ids);\r\n                        promise.done(function(count){\r\n                            FL.common.printToConsole(\">>>>>util.placeGridButtonsInDOM destroy removeRecordFromTable SUCCESS <<<<<\");\r\n                            if(count!=selectedModels.length)\r\n                                preStr = \"Count=\"+count+\" deleted instead of \"+selectedModels.length+\" --->\";\r\n                            FL.common.makeModalInfo(  preStr + \" were deleted....\");\r\n                            return;\r\n                        });\r\n                        promise.fail(function(err){FL.common.printToConsole(\">>>>>util.placeGridButtonsInDOM destroy removeRecordFromTable FAILURE <<<<<\"+err);\r\n                            FL.common.makeModalInfo( \"Impossible to delete \" + preStr + \". Error \"+err);\r\n                            return;\r\n                        });\r\n                     \r\n                    }else{\r\n                        FL.common.makeModalInfo(\"Nothing was deleted !!!\");\r\n                    }\r\n                });\r\n            }else{\r\n                FL.common.makeModalInfo(\"No selected rows. To delete one or more rows, click the left column checkbox.\");\r\n            }\r\n        });\r\n        // $(\"#_unSelect\").click(function () {\r\n        //     alert(\"Unselection !!!\");\r\n        //     // grid.clearSelectedModels();\r\n        // });\r\n        // $(clientSideFilter.el).css({float: \"right\", margin: \"20px\"});\r\n        // $('<p style=\"padding-top:30px;float:right;margin-right:800px\">abc</p>').insertBefore(\".backgrid\");\r\n        // $(\".backgrid\").before(\"<p style='padding-top:30px;float:right;margin-right:800px'>abcde</p>\");\r\n        // $(\"#_select\").insertBefore($(\".backgrid\"));\r\n    },\r\n    buildMasterDetailStructureFromAttributesArr: function(attributesArr){\r\n        var items = [];\r\n        var detailLine = null;\r\n        _.each(attributesArr, function(element,index){\r\n            var userType = FL.dd.userType(element);\r\n            detailLine = {\r\n                attribute:element.name, \r\n                description:element.description, \r\n                statement: \"The \" + element.name + \" of entity is...\",\r\n                userType:userType\r\n            };\r\n            items.push(detailLine);\r\n        });\r\n        return items;\r\n    },\r\n    singleFormTemplate: function(formTitle,entitySingular,fieldArr){// returns a function with a template that has the tagged fields\r\n        // returns a template function with tags for fields defined in fieldArr\r\n        // exemple of field Arr:\r\n        // fieldArr = [//fieldType:text,number,email,date\r\n        //     {fieldId: \"f1\",fieldLabel: \"Name\",fieldType: \"text\",fieldValue: \"<%= name %>\"},\r\n        //     {fieldId: \"f2\",fieldLabel: \"Age\",fieldType: \"number\",fieldValue: \"<%= age %>\"},\r\n        //     {fieldId: \"f3\",fieldLabel: \"Occupation\",fieldType: \"text\",fieldValue: \"<%= occupation %>\"}\r\n        // ];       \r\n        var base =\r\n            \"<div class='container'>\" +\r\n                \"<legend><%= title %></legend>\" +\r\n                \"<div class='row'>\" +\r\n                    \"<form class='form-horizontal col-sm-12'>\" +\r\n                        \"<fieldset>\" +\r\n                            \"<div class='row'>\" +\r\n                                \"<div class='col-sm-4'>\" +\r\n                                    \"<%= controlGroupHtml %>\" +\r\n                                \"</div>\" +\r\n                                \"<div class='col-sm-4'>\" +\r\n                                    \"<h5>Column 5</h5>\" +\r\n                                \"</div>\" +\r\n                                \"<div class='col-sm-4'>\" +\r\n                                    \"<h5>Column 9</h5>\" +\r\n                                \"</div>\" +\r\n                                \"</div>\" +\r\n                            \"</div>\" +\r\n                        \"</fieldset>\" +\r\n                        \"</br>\" +\r\n                        \"<div class='form-actions'>\" +\r\n                            \"<a href='#' class='btn btn-primary save'>Save</a>\" +\r\n                            \"<a href='#' class='btn delete'>Delete</a>\" +\r\n                        \"</div>\" +\r\n                    \"</form>\" +\r\n                \"</div>\" +\r\n                \"<div class='row status-bar'>\" +\r\n                    \"<div class='col-sm-12'>\" +\r\n                        \"<div class='alert alert-success' style='display: none'>\" +\r\n                            \"<b>Success!</b> <%= entitySingular %> saved successfully\" +\r\n                        \"</div>\" +\r\n                    \"</div>\" +\r\n                \"</div>\" +\r\n            \"</div>\";\r\n        var fieldControlGroup =\r\n            \"<div class='control-group'>\" +\r\n                \"<label for='<%= fieldId %>' class='control-label'><%= fieldLabel %>:</label>\" +\r\n                \"<div class='controls'>\" +\r\n                    \"<input type='<%= fieldType %>' id='<%= fieldId %>' name='<%= fieldId %>' value='<%= fieldValue %>'/>\" +\r\n                    \"<span class='help-inline'></span>\" +\r\n                \"</div>\" +\r\n            \"</div>\";\r\n\r\n        var test = {title:formTitle,entitySingular:entitySingular};\r\n\r\n        // fieldArr = [//fieldType:text,number,email,date\r\n        //     {fieldId: \"f1\",fieldLabel: \"Name\",fieldType: \"text\",fieldValue: \"<%= name %>\"},\r\n        //     {fieldId: \"f2\",fieldLabel: \"Age\",fieldType: \"number\",fieldValue: \"<%= age %>\"},\r\n        //     {fieldId: \"f3\",fieldLabel: \"Occupation\",fieldType: \"text\",fieldValue: \"<%= occupation %>\"}\r\n        // ];\r\n\r\n        \r\n        var fieldControlGroupHtml0 = '';\r\n        var compiledFieldControlGroup = _.template(fieldControlGroup);\r\n        var fieldControlGroupJSON = null;\r\n        _.each(fieldArr, function(el){//fills fieldControlGroupHtml0 with all the fields in fieldArr\r\n            fieldControlGroupJSON = {fieldId: el.fieldId,fieldLabel: el.fieldLabel,fieldType: el.fieldType,fieldValue: el.fieldValue};\r\n            fieldControlGroupHtml0 += compiledFieldControlGroup(fieldControlGroupJSON);\r\n        });\r\n\r\n\r\n        \r\n\r\n        var compiledBase = _.template(base);\r\n        var baseJSON = {title: test.title,controlGroupHtml: fieldControlGroupHtml0,entitySingular: test.entitySingular};\r\n        var fullHtml = compiledBase(baseJSON);//title,controlGroupHtml,entitySingular\r\n\r\n        //fullHtml has the final template with tags for the field names\r\n        var funcToReturn = _.template(fullHtml);\r\n        return funcToReturn;\r\n    }\r\n};"]}